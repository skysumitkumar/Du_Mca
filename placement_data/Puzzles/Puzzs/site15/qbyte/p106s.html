<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>Nick's Mathematical Puzzles: Solution 106</title>
<meta name="Description" content="Probability puzzle solution: Flying cards" />
<meta name="Keywords" content="probability,mathematical puzzle" /><link rel="stylesheet" href="puzz4.css" tppabs="http://www.qbyte.org/puzzles/puzz4.css" type="text/css" /><link rel="shortcut icon" href="javascript:if(confirm('http://www.qbyte.org/favicon.ico  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/favicon.ico'" tppabs="http://www.qbyte.org/favicon.ico" /><script src="p106.js" tppabs="http://www.qbyte.org/puzzles/p106.js" type="text/javascript"></script></head>
<body><div class="e">
<div class="m"><a href="#main"><img src="s.gif" tppabs="http://www.qbyte.org/puzzles/s.gif" alt="Skip to main content." height="1" width="1" /></a><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div>
<h1 id="main">Solution to puzzle 106: Flying cards</h1>
<p><a href="#sol"><img src="s.gif" tppabs="http://www.qbyte.org/puzzles/s.gif" alt="Skip restatement of puzzle." height="1" width="1" /></a>A standard pack of cards is thrown into the air in such a way that each card, independently, is equally likely to land face up or face down.&nbsp; The total value of the cards which landed face up is then calculated.&nbsp; (Card values are assigned as follows: Ace=1, 2=2,&nbsp;...&nbsp;, 10=10, Jack=11, Queen=12, King=13.&nbsp; There are no jokers.)</p><p>What is the probability that the total value is divisible by 13?</p><hr />
<p id="sol">There are 2<sup>52</sup> equally likely configurations of face up/face down.&nbsp; We seek the number of configurations for which the sum of face up card values is divisible by&nbsp;13.</p>
<h2>Generating function</h2>
<p>Consider the <a href="javascript:if(confirm('http://mathworld.wolfram.com/GeneratingFunction.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/GeneratingFunction.html'" tppabs="http://mathworld.wolfram.com/GeneratingFunction.html">generating function</a><br />
<span class="i">f(x) = (1 + x)<sup>4</sup>(1 + x<sup>2</sup>)<sup>4</sup>...(1 + x<sup>13</sup>)<sup>4</sup> = a<sub>0</sub> + a<sub>1</sub>x + a<sub>2</sub>x<sup>2</sup> ... + a<sub>364</sub>x<sup>364</sup>.</span><span class="i">(1)</span></p>
<p>There is a <a href="javascript:if(confirm('http://en.wikipedia.org/wiki/Bijection  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://en.wikipedia.org/wiki/Bijection'" tppabs="http://en.wikipedia.org/wiki/Bijection">bijection</a> between each card configuration and a contribution to the corresponding term in the generating function.&nbsp; Each exponent in the generating function represents a total score; the corresponding coefficient represents the number of ways of obtaining that score.</p>
<p>Hence we seek the sum S = a<sub>0</sub> + a<sub>13</sub> + ... + a<sub>364</sub>.</p>
<h2>Express S in terms of f(1), f(w), ... , f(w<sup>12</sup>)</h2>
<p>Let w be a (complex) primitive 13th <a href="javascript:if(confirm('http://mathworld.wolfram.com/RootofUnity.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/RootofUnity.html'" tppabs="http://mathworld.wolfram.com/RootofUnity.html">root of unity</a>.&nbsp; Then w<sup>13</sup>&nbsp;=&nbsp;1 and 1&nbsp;+&nbsp;w&nbsp;+&nbsp;w<sup>2</sup>&nbsp;+&nbsp;...&nbsp;+&nbsp;w<sup>12</sup>&nbsp;=&nbsp;0.&nbsp; Consider</p>
<table class="i" cellspacing="1" cellpadding="1"><tr><td>f(1) </td><td>= a<sub>0</sub> + </td><td>a<sub>1</sub> + </td><td>a<sub>2</sub> + ... + </td><td>a<sub>13</sub> + </td><td>a<sub>14</sub> + ... + </td><td>a<sub>363</sub> + </td><td>a<sub>364</sub></td></tr>
<tr><td>f(w) </td><td>= a<sub>0</sub> + </td><td>a<sub>1</sub>w + </td><td>a<sub>2</sub>w<sup>2</sup> + ... + </td><td>a<sub>13</sub> + </td><td>a<sub>14</sub>w + ... + </td><td>a<sub>363</sub>w<sup>12</sup> + </td><td>a<sub>364</sub></td></tr>
<tr><td>f(w<sup>2</sup>) </td><td>= a<sub>0</sub> + </td><td>a<sub>1</sub>w<sup>2</sup> + </td><td>a<sub>2</sub>w<sup>4</sup> + ... + </td><td>a<sub>13</sub> + </td><td>a<sub>14</sub>w<sup>2</sup> + ... + </td><td>a<sub>363</sub>w<sup>11</sup> + </td><td>a<sub>364</sub></td></tr>
<tr><td>f(w<sup>3</sup>) </td><td>= a<sub>0</sub> + </td><td>a<sub>1</sub>w<sup>3</sup> + </td><td>a<sub>2</sub>w<sup>6</sup> + ... + </td><td>a<sub>13</sub> + </td><td>a<sub>14</sub>w<sup>3</sup> + ... + </td><td>a<sub>363</sub>w<sup>10</sup> + </td><td>a<sub>364</sub></td></tr>
<tr><td>&nbsp;...</td></tr>
<tr><td>f(w<sup>12</sup>) </td><td>= a<sub>0</sub> + </td><td>a<sub>1</sub>w<sup>12</sup> + </td><td>a<sub>2</sub>w<sup>11</sup> + ... + </td><td>a<sub>13</sub> + </td><td>a<sub>14</sub>w<sup>12</sup> + ... + </td><td>a<sub>363</sub>w + </td><td>a<sub>364</sub></td></tr></table>
<p>Since w is a <em>primitive</em> root of unity, the set of values {w<sup>k</sup>, (w<sup>k</sup>)<sup>2</sup>, ... , (w<sup>k</sup>)<sup>12</sup>} is a permutation of {w, w<sup>2</sup>, ... , w<sup>12</sup>}, for any integer k not divisible by&nbsp;13.<br />
Therefore, adding these 13 equations, we obtain<br />
<span class="i">f(1) + f(w) + ... + f(w<sup>12</sup>) = 13(a<sub>0</sub> + a<sub>13</sub> + ... + a<sub>364</sub>).</span><br />
Hence S = [f(1) + f(w) + ... + f(w<sup>12</sup>)]/13.</p>
<h2>Evaluate f(1), f(w), ... , f(w<sup>12</sup>)</h2>
<p>Clearly, from (1), f(1) = 2<sup>52</sup>.<br />
Also, f(w) = [(1 + w)(1 + w<sup>2</sup>)...(1 + w<sup>13</sup>)]<sup>4</sup>.<span class="i">(2)</span></p>
<p>Consider g(x) = x<sup>13</sup> - 1 = (x - w)(x - w<sup>2</sup>)...(x - w<sup>13</sup>).<br />
Then g(-1) = -2 = (-1 - w)(-1 - w<sup>2</sup>)...(-1 - w<sup>13</sup>).<br />
Hence (1 + w)(1 + w<sup>2</sup>)...(1 + w<sup>13</sup>) = 2.</p>
<p>Again, since w is a primitive root of unity, the terms of f(w<sup>2</sup>), ... , f(w<sup>12</sup>), will simply be a permutation of those for f(w), in&nbsp;(2).<br />
Hence f(w) = f(w<sup>2</sup>) = ... = f(w<sup>12</sup>) = 2.</p>
<h2>Conclusion</h2>
<p>Putting the above results together, we obtain S = (2<sup>52</sup> + 12&middot;2<sup>4</sup>)/13.</p>
<p>Therefore, the probability that the total value is divisible by 13 is S/2<sup>52</sup> = </p><img src="p106a.gif" tppabs="http://www.qbyte.org/puzzles/p106a.gif" width="607" height="48" alt="(2^52 + 12*2^4)/(13*2^52) = 5412980321359/70368744177664 = 0.0769230769230802025049342773854732513427734375." class="i" />
<script type="text/javascript">
writeF();
</script>
<hr /><h2 class="h3">Further reading</h2>
<p><a href="javascript:if(confirm('http://www.mathematik.uni-bielefeld.de/~sillke/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mathematik.uni-bielefeld.de/~sillke/'" tppabs="http://www.mathematik.uni-bielefeld.de/~sillke/">Torsten Sillke</a> gives a more general solution to the problem that served as the inspiration for this puzzle (see below) in <a href="javascript:if(confirm('http://www.mathematik.uni-bielefeld.de/~sillke/PUZZLES/partition-probability  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mathematik.uni-bielefeld.de/~sillke/PUZZLES/partition-probability'" tppabs="http://www.mathematik.uni-bielefeld.de/~sillke/PUZZLES/partition-probability">partition probability</a>.</p>
<p class="c"><cite>Source: Inspired by problem K 24 in <img src="pdf.gif" tppabs="http://www.qbyte.org/puzzles/pdf.gif" width="34" height="20" alt="(Adobe) Portable Document Format" class="w" /> <a href="javascript:if(confirm('http://my.netian.com/~ideahitme/pen050222.pdf  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://my.netian.com/~ideahitme/pen050222.pdf'" tppabs="http://my.netian.com/~ideahitme/pen050222.pdf">Problems in Elementary Number Theory</a></cite></p>
<div id="n" class="m"><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div></div></body></html>