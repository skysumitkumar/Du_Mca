<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>Nick's Mathematical Puzzles: Solution 40</title>
<meta name="Description" content="Probability puzzle solution: No consecutive heads" />
<meta name="Keywords" content="probability,coin,consecutive heads,Fibonacci,recurrence relation,mathematical puzzle" /><link rel="stylesheet" href="puzz4.css" tppabs="http://www.qbyte.org/puzzles/puzz4.css" type="text/css" /><link rel="shortcut icon" href="javascript:if(confirm('http://www.qbyte.org/favicon.ico  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/favicon.ico'" tppabs="http://www.qbyte.org/favicon.ico" /><style type="text/css">.dq{list-style:lower-alpha}</style></head>
<body><div class="e">
<div class="m"><a href="#main"><img src="s.gif" tppabs="http://www.qbyte.org/puzzles/s.gif" alt="Skip to main content." height="1" width="1" /></a><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div>
<h1 id="main">Solution to puzzle 40: No consecutive heads</h1>
<p>A fair coin is tossed n times.&nbsp; What is the probability that no two consecutive heads appear?</p><hr />
<p>Let f(n) be the number of sequences of heads and tails, of length n, in which two consecutive heads do not appear.<br />
The total number of possible sequences from n coin tosses is 2<sup>n</sup>.<br />
So the probability that no two consecutive heads occur in n coin tosses is f(n) / 2<sup>n</sup>.</p>
<p>By enumeration, f(1) = 2, since we have {H, T}, and f(2) = 3, from {HT, TH, TT}.</p>
<p>We then derive a <a href="javascript:if(confirm('http://en.wikipedia.org/wiki/Recurrence  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://en.wikipedia.org/wiki/Recurrence'" tppabs="http://en.wikipedia.org/wiki/Recurrence">recurrence relation</a> for f(n), as follows.</p>
<p>A sequence of n &gt; 2 coin tosses has no consecutive heads if, and only if:</p>
<ol class="dq"><li>It begins with a tail, and is followed by n-1 tosses with no consecutive heads; or</li><li>It begins with a head, then a tail, and is followed by n-2 tosses with no consecutive heads.</li></ol>
<p>These two possibilities are mutually exclusive, so we have f(n) = f(n-1) + f(n-2).</p>
<p>This is simply the <a href="javascript:if(confirm('http://mathworld.wolfram.com/FibonacciNumber.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/FibonacciNumber.html'" tppabs="http://mathworld.wolfram.com/FibonacciNumber.html">Fibonacci sequence</a>, shifted forward by two terms.</p>
<p>The Fibonacci sequence is defined by the recurrence equation F<sub>0</sub>&nbsp;=&nbsp;0, F<sub>1</sub>=&nbsp;1, F<sub>n</sub>&nbsp;=&nbsp;F<sub>n-1</sub>&nbsp;+&nbsp;F<sub>n-2</sub>, for n&nbsp;&gt;&nbsp;1.<br />
So F<sub>3</sub> = 2 and F<sub>4</sub> = 3, and therefore f(n) = F<sub>n+2</sub>.</p>
<p>A <a href="javascript:if(confirm('http://mathworld.wolfram.com/Closed-FormSolution.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/Closed-FormSolution.html'" tppabs="http://mathworld.wolfram.com/Closed-FormSolution.html">closed form formula</a> for the Fibonacci sequence is&nbsp; F<sub>n</sub> = (Phi<sup>n</sup> - phi<sup>n</sup>) /<img src="root5.gif" tppabs="http://www.qbyte.org/puzzles/root5.gif" width="18" height="13" alt="root 5" />,<br />
where Phi = (1 + <img src="root5.gif" tppabs="http://www.qbyte.org/puzzles/root5.gif" width="18" height="13" alt="root 5" />)/2 and phi = (1 - <img src="root5.gif" tppabs="http://www.qbyte.org/puzzles/root5.gif" width="18" height="13" alt="root 5" />)/2 are the roots of the quadratic equation x<sup>2</sup>&nbsp;-&nbsp;x&nbsp;-&nbsp;1&nbsp;=&nbsp;0.</p>
<p>Therefore the probability that no two consecutive heads appear in n tosses of a coin is F<sub>n+2</sub>&nbsp;/&nbsp;2<sup>n</sup>&nbsp;=&nbsp;(Phi<sup>n+2</sup>&nbsp;-&nbsp;phi<sup>n+2</sup>)&nbsp;/&nbsp;2<sup>n</sup>&middot;<img src="root5.gif" tppabs="http://www.qbyte.org/puzzles/root5.gif" width="18" height="13" alt="root 5" />.</p>
<hr /><h2 class="h3">Further reading</h2>
<ol><li><a href="javascript:if(confirm('http://www.mcs.surrey.ac.uk/Personal/R.Knott/Fibonacci/fib.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mcs.surrey.ac.uk/Personal/R.Knott/Fibonacci/fib.html'" tppabs="http://www.mcs.surrey.ac.uk/Personal/R.Knott/Fibonacci/fib.html">Fibonacci Numbers and the Golden Section</a></li>
<li><a href="javascript:if(confirm('http://jwilson.coe.uga.edu/emt669/Student.Folders/Frietag.Mark/Homepage/Goldenratio/goldenratio.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://jwilson.coe.uga.edu/emt669/Student.Folders/Frietag.Mark/Homepage/Goldenratio/goldenratio.html'" tppabs="http://jwilson.coe.uga.edu/emt669/Student.Folders/Frietag.Mark/Homepage/Goldenratio/goldenratio.html">Phi: That Golden Number</a></li>
<li><a href="javascript:if(confirm('http://mathworld.wolfram.com/FibonacciNumber.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/FibonacciNumber.html'" tppabs="http://mathworld.wolfram.com/FibonacciNumber.html">Fibonacci Number</a></li><li><a href="javascript:if(confirm('http://mathworld.wolfram.com/GoldenRatio.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/GoldenRatio.html'" tppabs="http://mathworld.wolfram.com/GoldenRatio.html">Golden Ratio</a></li></ol>
<p class="c"><cite>Source: Traditional</cite></p>
<div id="n" class="m"><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div></div></body></html>