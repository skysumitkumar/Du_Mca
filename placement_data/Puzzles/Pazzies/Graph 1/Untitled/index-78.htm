
<!-- RESG: 7/7/2005 4:27:38 AM - RESX: 1/1/0001 12:00:00 AM -->
<!-- (c) 2005 Microsoft Corporation. All Rights Reserved -->

<html><head><link type='text/css' rel='Stylesheet' href="d3e6e07eD.css" tppabs="http://support.microsoft.com/mnpresource/d3e6e07eD.css"><link rel='stylesheet' type='text/css' href="b433593aD.css" tppabs="http://support.microsoft.com/mnpresource/b433593aD.css"><script language='JavaScript'>var doImage=doImage;var TType=TType;function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}function setMSResearch(){var time=new Date();if(document.cookie.indexOf('msresearch=1 ')==-1){document.cookie='msresearch='+time.getTime()+':'+escape(document.location)+':'+escape(document.referrer)+'; path=/; domain=.microsoft.com; ';}}function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=localhost&TYPE=' + tt + '&p=MNPGenerator" width=0 height=0 hspace=0 vspace=0 border=0></div></layer>');}if((document.cookie.indexOf('msresearch=1 ')==-1)&&(document.cookie.indexOf('msresearch=')!=-1)){setInterval("setMSResearch()",1000);}}</script><script type="text/javascript" src="common.js-2" tppabs="http://support.microsoft.com/common/script/gsfx/common.js?2"></script><title>IIS lockdown and URLscan configurations in an Exchange environment</title><meta name="robots" content="nofollow,noarchive"><meta name="KBParents" content="4079 4097 730 4062 1776 1760 "><meta name="Keywords" content="kbprb KB309508"><meta name="Description" content="Note This article refers to issues with Exchange 2000 and Exchange Server 5.5 when you apply the IIS lockdown tool version 1.0. Microsoft recommends that you download the latest version of the IIS lockdown tool:..."><meta name="MS.LOCALE" content="en"><meta http-equiv="content-type" content="text/html; charset=utf-8"><xmlreader><link rel="stylesheet" type="text/css" href="default.css-2.css" tppabs="http://support.microsoft.com/common/css/default/default.css?2"><link rel="stylesheet" type="text/css" href="xmlContent.css-2.css" tppabs="http://support.microsoft.com/common/css/default/xmlContent.css?2"><link rel="stylesheet" type="text/css" href="override.css-2.css" tppabs="http://support.microsoft.com/common/css/default/ie/override.css?2"></xmlreader><style type="text/css">#SendFeedback_tr{display:none;}</style><script type="text/javascript">var PersonalizationInfo='a2IzMDk1MDgIZW4tdXMISUlTIGxvY2tkb3duIGFuZCBVUkxzY2FuIGM_';SaveToFavoritesData.savingMsg='Saving Favorites';SaveToFavoritesData.connectionErrorMsg='Cannot Connect';SaveToFavoritesData.savedMsg='Favorites Saved';SaveToFavoritesData.noSaveErrorMsg='Cannot Save';SaveToFavoritesData.surveyUrl='\x2fcommon\x2fsurvey.aspx\x3fscid\x3dsw\x3ben\x3b1076\x26surveystyle\x3dpopup\x26showpage\x3d1\x26site\x3dgn\x26siteregion\x3den-us\x26url\x3d%2fdefault.aspx%2fkb%2f309508%2f\x26p0\x3dkb\x26p1\x3den-us\x26p2\x3d309508';SaveToFavoritesData.noCookieUrl='\x2fgp\x2fnocookies\x2f';var gCookieDomain='';</script></head><body onload="thisLoad();" onunload="thisUnload();"><script type="text/javascript">if (self.name == "MNPMainFrame") top.location.href = self.location.href;</script><div id="msviMasthead" xmlns:Utility="http://www.microsoft.com/MSCOM/VisualIdentity/Utility"><table cellpadding="0" cellspacing="0" width="100%" border="0"><tr><td width="100%"><table cellpadding="0" cellspacing="0" width="100%" height="22" border="0"><tr><td id="msviRegionIdGraphic" bgcolor="#4B92D9"><a href="international.aspx.htm" tppabs="http://support.microsoft.com/common/international.aspx"><img src="99b166acD.gif" tppabs="http://support.microsoft.com/mnpresource/99b166acD.gif" height="22" alt="United States" title="Language Options" border="0"></a></td><td width="100%" bgcolor="#1E77D3"><img src="d80d0ecfD.gif" tppabs="http://support.microsoft.com/mnpresource/d80d0ecfD.gif" width="250" height="22" alt="*" title=""></td></tr></table></td><td id="msviGlobalToolbar" bgcolor="#1E77D3" height="22" nowrap dir="ltr" align="left"><table cellpadding="0" cellspacing="0" border="0"><tr><td class="gt0" nowrap onmouseover="mhHover('msviGlobalToolbar', 0, 'gt1')" onmouseout="mhHover('msviGlobalToolbar', 0, 'gt0')"><a href="javascript:if(confirm('http://www.microsoft.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.microsoft.com/'" tppabs="http://www.microsoft.com/">Microsoft.com Home</a></td><td class="gtsep">|</td><td class="gt0" nowrap onmouseover="mhHover('msviGlobalToolbar', 2, 'gt1')" onmouseout="mhHover('msviGlobalToolbar', 2, 'gt0')"><a href="en-us.mspx.htm" tppabs="http://support.microsoft.com/library/toolbar/3.0/sitemap/en-us.mspx">Site Map</a></td></tr></table></td></tr><tr valign="top"><td width="100%"><table cellpadding="0" cellspacing="0" width="100%" height="42" border="0" style="height: expression(parentElement.offsetHeight)"><tr valign="top"><td id="msviBrandBanner" bgcolor="0A6CCE"><a href="javascript:if(confirm('http://www.microsoft.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.microsoft.com/'" tppabs="http://www.microsoft.com/"><img src="ms_masthead_ltr.gif" tppabs="http://support.microsoft.com/library/toolbar/3.0/images/banners/ms_masthead_ltr.gif" width="136" height="42" alt="Microsoft" title="" border="0"></a></td><td width="100%" bgcolor="#FFFFFF"><img src="a0250c0dD.gif" tppabs="http://support.microsoft.com/mnpresource/a0250c0dD.gif" width="250" height="42" alt="*" title=""></td></tr></table></td><td id="msviGlobalSearch" bgcolor="#FFFFFF">Search Microsoft.com for:<br><form id="msviSearchForm" action="javascript:if(confirm('http://search.microsoft.com/search/results.aspx?st=b&na=88&View=en-us&qu=Go  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://search.microsoft.com/search/results.aspx?st=b&na=88&View=en-us&qu=Go'" tppabs="http://support.microsoft.com/library/toolbar/3.0/search.aspx?View=en-us&charset=iso-8859-1&qu=Go"><input type="hidden" name="View" value="en-us"><input type="hidden" name="charset" value="iso-8859-1"><nobr><div style="height: 18px"><input name="qu" id="msviSearchBox" maxlength="255"><input id="msviGoButton" type="submit" value="Go"></div></nobr></form></td></tr></table><table id="msviSubbanner" bgcolor="#003399" width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td><img src="4101ccf1D.gif" tppabs="http://support.microsoft.com/mnpresource/4101ccf1D.gif" width="467" height="26" alt="Help and Support" title="" border="0"></td><td width="100%">&nbsp;</td></tr></table><div id="msviLocalToolbar"><table cellpadding="0" cellspacing="0" width="100%" height="19" border="0"><tr><td nowrap id="msviHomePageLink"><a href="index.htm" tppabs="http://support.microsoft.com/">Help and Support Home</a></td><td><span class="ltsep">|</span></td><td class="lt0" nowrap onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')"><a href="-target=hub.htm" tppabs="http://support.microsoft.com/select/?target=hub">Select a Product</a></td><td><span class="ltsep">|</span></td><td class="lt0" nowrap onmouseover="mhHover('msviLocalToolbar', 4, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 4, 'lt0')"><a href="-adv=1.htm" tppabs="http://support.microsoft.com/search/?adv=1">Search (KB)</a></td><td width="100%"></td></tr></table></div></div><table cellpadding="0" cellspacing="0" border="0" width="100%" dir="LTR"><tr valign="top">          <td width="100%" dir="LTR">        <XMLREADER><div id="contentArea"><div id="mainRow"><div class="primaryTable"><table cellpadding="0" cellspacing="0" class="primaryTable"><tr><td class="primaryMainColumn"><div id="mainColumn"><div id="kb" class="kb"><div id="default" class="default"><!-- - -KB 3 start- - --><a id="toc"></a><h1 class="title">IIS lockdown and URLscan configurations in an Exchange environment</h1><div class="appliesToLink"><a href="#appliesto">View products that this article applies to.</a></div><div class="articleProperty"><table><tr><td class="label">Article ID</td><td class="text">:</td><td class="text">309508</td></tr><tr><td class="label">Last Review</td><td class="text">:</td><td class="text">April 25, 2005</td></tr><tr><td class="label">Revision</td><td class="text">:</td><td class="text">6.2</td></tr></table></div><div class="notice">This article was previously published under Q309508</div><div class="notice"></div><div class="toc"><h5>On this page</h5><table class="tallTable"><tr><td class="image"><a href="#kb1"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="SYMPTOMS" title="SYMPTOMS"></a></td><td class="text" colspan="2"><a href="#kb1">SYMPTOMS</a></td></tr><tr><td class="image"><a href="#kb2"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="CAUSE" title="CAUSE"></a></td><td class="text" colspan="2"><a href="#kb2">CAUSE</a></td></tr><tr><td class="image"><a href="#kb3"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="RESOLUTION" title="RESOLUTION"></a></td><td class="text" colspan="2"><a href="#kb3">RESOLUTION</a></td></tr><tr class="subHeader"><td class="space"> </td><td class="image"><a href="#XSLTH3127121124120121120120"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="IIS Lockdown on Exchange 2000 Servers" title="IIS Lockdown on Exchange 2000 Servers"></a></td><td class="text"><a href="#XSLTH3127121124120121120120">IIS Lockdown on Exchange 2000 Servers</a></td></tr><tr class="subHeader"><td class="space"> </td><td class="image"><a href="#XSLTH3134121124120121120120"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="IIS Lockdown on Exchange Server 5.5 Computers" title="IIS Lockdown on Exchange Server 5.5 Computers"></a></td><td class="text"><a href="#XSLTH3134121124120121120120">IIS Lockdown on Exchange Server 5.5 Computers</a></td></tr><tr class="subHeader"><td class="space"> </td><td class="image"><a href="#XSLTH3141121124120121120120"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="URLscan on Exchange 2000 Servers" title="URLscan on Exchange 2000 Servers"></a></td><td class="text"><a href="#XSLTH3141121124120121120120">URLscan on Exchange 2000 Servers</a></td></tr><tr class="subHeader"><td class="space"> </td><td class="image"><a href="#XSLTH3190121124120121120120"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="URLscan on Exchange Server 5.5 Computers" title="URLscan on Exchange Server 5.5 Computers"></a></td><td class="text"><a href="#XSLTH3190121124120121120120">URLscan on Exchange Server 5.5 Computers</a></td></tr><tr><td class="image"><a href="#appliesto"><img src="downArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/PUBLIC/EN-US/downArrow.gif" alt="APPLIES TO" title="APPLIES TO"></a></td><td class="text" colspan="2"><a href="#appliesto">APPLIES TO</a></td></tr></table></div><div class="section"><a id="kb1"></a><h2 class="subTitle">SYMPTOMS</h2><div class="sbody"><b>Note</b> This article refers to issues with Exchange 2000 and Exchange
		  Server 5.5 when you apply the IIS lockdown tool version 1.0. Microsoft
		  recommends that you download the latest version of the IIS lockdown tool: <div class="indent"><span><a href="javascript:if(confirm('http://www.microsoft.com/downloads/release.asp?ReleaseID=43955  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.microsoft.com/downloads/release.asp?ReleaseID=43955'" tppabs="http://www.microsoft.com/downloads/release.asp?ReleaseID=43955">http://www.microsoft.com/downloads/release.asp?ReleaseID=43955</a></span></div>For additional information, click the article number
			 below to view the article in the Microsoft Knowledge Base: <div class="indent"><span><a class="KBlink" href="javascript:if(confirm('http://support.microsoft.com/kb/309677/EN-US/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/kb/309677/EN-US/'" tppabs="http://support.microsoft.com/kb/309677/EN-US/">309677</a></span> XADM: Known Issues and Fine Tuning When You Use the IIS Lockdown Wizard in an Exchange 2000 Environment
</div> The Internet Information Services (IIS) security
		  tools, IISlockD and URLscan, must be configured appropriately for Exchange.
		  This article describes the configuration that is required for these tools in
		  Exchange 2000 Server and Exchange Server 5.5 environments. Typical symptoms of
		  incorrect of IISlockD and URLscan configuration include:
		  <table class="list"><tr><td class="bullet">•</td><td class="text">Microsoft Outlook Web Access (OWA). When you gain access to
				OWA, your mail items, Calendar items, and Contacts may be missing. In addition,
				if you attempt to gain access to OWA from a browser on the Exchange 2000
				server, you may receive the following error message:<div class="errormsg"> A
				Runtime Error has occurred. <br> Do you wish to Debug? <br> Line: 878<br>
				Error: The handle is in the wrong state for the requested operation
				</div></td></tr><tr><td class="bullet">•</td><td class="text">Exchange System Manager. When you try to click to expand
				the public folder tree in Exchange System Manager, you may receive the
				following error message:<div class="errormsg"> The object is no longer
				available. Press F5 to refresh the display, and then try again. <br> ID no:
				80040e19 <br> Exchange System Manager </div></td></tr><tr><td class="bullet">•</td><td class="text">Exchange System Manager. When you try to expand the public
				folder tree in Exchange System Manager, you may receive the following error
				message: <div class="errormsg">The operation failed due an internal server
				error. c1030af2</div></td></tr><tr><td class="bullet">•</td><td class="text">Exchange Instant Messaging. When you try to sign in to
				Exchange Instant Messaging, you may receive the following error
				message:<div class="errormsg"> Signing in to Microsoft Exchange Instant
				Messaging failed because the service is temporarily unavailable. Please try
				again later. </div></td></tr></table><div class="topOfPage"><table><tr><td class="image"><a href="#toc"><img src="upArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/upArrow.gif" alt="Back to the top" title="Back to the top"></a></td><td class="text"><a href="#toc">Back to the top</a></td></tr></table></div></div><a id="kb2"></a><h2 class="subTitle">CAUSE</h2><div class="sbody"> This issue can occur because the default configuration of
		  the IISlockD and URLScan security tools assumes that the server is serving
		  static content only. Exchange 2000 components use Web Distributed Authoring and
		  Versioning (WebDAV) and other Hypertext Transfer Protocol (HTTP) verbs that are
		  not allowed by the default configuration. Exchange Server 5.5 components use
		  Active Server Pages (ASP) that are disabled by default. <div class="topOfPage"><table><tr><td class="image"><a href="#toc"><img src="upArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/upArrow.gif" alt="Back to the top" title="Back to the top"></a></td><td class="text"><a href="#toc">Back to the top</a></td></tr></table></div></div><a id="kb3"></a><h2 class="subTitle">RESOLUTION</h2><div class="sbody"> Please examine these settings carefully before you apply
		  them to your server. They are designed to allow Exchange 2000 Server and
		  Exchange Server 5.5 to work optimally, but may have other effects which you may
		  not expect. For example, the URLscan INI settings below will affect IIS. If you
		  read the "DenyExtensions" section of the INI settings below, you can see that
		  these settings prevent IIS from serving most forms of content other than static
		  .HTM or .HTML pages.<br><br> This section includes the following sections:
		  <span><a id="10"></a></span><table class="list"><tr><td class="bullet">•</td><td class="text"><span><a href="#1">IIS Lockdown on Exchange
				2000 Servers</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#2">IIS Lockdown on Exchange
				Server 5.5 Computers</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#3">URLscan on Exchange 2000
				Servers</a></span><table class="list"><tr><td class="bullet">•</td><td class="text"><span><a href="#4">OWA</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#5">Exchange System Manager
					 for Public Folder Management</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#6">Instant
					 Messaging</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#7">Web
					 Folders</a></span></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#8">Custom WebDAV
					 Programs</a></span></td></tr></table></td></tr><tr><td class="bullet">•</td><td class="text"><span><a href="#9">URLscan on Exchange Server
				5.5 Computers</a></span></td></tr></table><span><a id="1"></a></span><a id="XSLTH3127121124120121120120"></a><h3>IIS Lockdown on Exchange 2000 Servers</h3> In Exchange 2000 environments, the lockdown tool does not
		  accommodate Exchange installable file system (IFS) mounted drives (typically
		  drive M). To use the lockdown tool on Exchange 2000 servers:
		  <table class="list"><tr><td class="number">1.</td><td class="text">Run IISlockD.exe.</td></tr><tr><td class="number">2.</td><td class="text">Click <b>Advanced Lockdown</b>, and then click <b>Next</b>.</td></tr><tr><td class="number">3.</td><td class="text">The <b>Remove Script Mappings</b> dialog box is displayed:
				<table class="list"><tr><td class="number">a. </td><td class="text">If the <strong class="uiterm">Disable support for Active Server Pages
					 (.asp)</strong> check box is selected, the OWA <strong class="uiterm">Multimedia</strong> button does not
					 function and the <strong class="uiterm">Log Off</strong> button does not function. The following Microsoft Knowledge Base article describes the process
					 to disable the multimedia button for customers who do not have a unified
					 messaging solution:
					 <div class="indent"><span><a class="KBlink" href="javascript:if(confirm('http://support.microsoft.com/kb/288119/EN-US/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/kb/288119/EN-US/'" tppabs="http://support.microsoft.com/kb/288119/EN-US/">288119</a></span> XWEB: How to Disable the Multimedia Button in OWA
</div> When Active Server Pages (ASP) pages are disabled,
					 unified messaging still functions with the WAV file attachment.</td></tr><tr><td class="number">b. </td><td class="text">If the <strong class="uiterm">Disable support for the .HTR scripting
					 (.htr)</strong> check box is selected, the OWA Change Password feature does not
					 function. This OWA feature is disabled by default. The following Knowledge Base
					 article describes the process to hide the <b>Change Password</b> button in OWA:<div class="indent"><span><a class="KBlink" href="javascript:if(confirm('http://support.microsoft.com/kb/297121/EN-US/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/kb/297121/EN-US/'" tppabs="http://support.microsoft.com/kb/297121/EN-US/">297121</a></span> XWEB: How to Hide the Change Password Button on the Outlook Web Access Options Page
</div></td></tr></table></td></tr><tr><td class="number">4.</td><td class="text">Click <b>Next</b>.</td></tr><tr><td class="number">5.</td><td class="text">The <b>Additional Lockdown Actions</b> dialog box is displayed:
				<table class="list"><tr><td class="number">a. </td><td class="text">Click to clear the <strong class="uiterm">Disable Distributed
					 Authoring and Versioning (WebDAV)</strong> check box.</td></tr><tr><td class="number">b. </td><td class="text">Click to clear the <strong class="uiterm">Set file permissions to
					 prevent the IIS anonymous users from writing to content directories</strong>
					 check box. This excludes the IIS virtual directories that are mapped to
					 Exchange IFS.</td></tr></table></td></tr><tr><td class="number">6.</td><td class="text">Click <b>Next</b>, and then click <b>Yes</b> to complete the lockdown process.</td></tr></table> To manually set the file permissions for the IIS anonymous
		  user, set an explicit Deny All Access Control Entry (ACE) for anonymous Web
		  users for each IIS virtual directory:
		  <table class="list"><tr><td class="number">1.</td><td class="text">Start the Internet Services Manager Microsoft Management
				Console (MMC).</td></tr><tr><td class="number">2.</td><td class="text">Click to expand the <b>Default Web Site</b>.</td></tr><tr><td class="number">3.</td><td class="text">For each virtual directory:
				<table class="list"><tr><td class="number">a. </td><td class="text">Click to select a virtual directory, right-click the
					 virtual directory, and then click <b>Properties</b>.</td></tr><tr><td class="number">b. </td><td class="text">On the <b>Virtual Directory</b> tab, note the local path.</td></tr><tr><td class="number">c. </td><td class="text">Start Microsoft Windows Explorer, and then locate the
					 local path folder.</td></tr><tr><td class="number">d. </td><td class="text">Right-click the folder, and then click <b>Properties</b>.</td></tr><tr><td class="number">e. </td><td class="text">Click the <b>Security</b> tab.</td></tr><tr><td class="number">f. </td><td class="text">Click <b>Add</b>.</td></tr><tr><td class="number">g. </td><td class="text">Click to select the <b>_Web Anonymous Users</b> and <b>_Web Applications</b> accounts, and then click <b>OK</b>.</td></tr><tr><td class="number">h. </td><td class="text">Click to select the <b>_Web Anonymous Users</b> account, and then deny Full Control ACE.</td></tr><tr><td class="number">i. </td><td class="text">Click to select the <b>_Web Applications</b> account, and then deny Full Control ACE.</td></tr></table></td></tr><tr><td class="number">4.</td><td class="text">Repeat step 3 for each virtual directory, excluding the
				Exchange and Exadmin virtual roots.</td></tr></table><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="2"></a></span><a id="XSLTH3134121124120121120120"></a><h3>IIS Lockdown on Exchange Server 5.5 Computers</h3> To use the lockdown tool on Exchange Server 5.5 computers:
		  <table class="list"><tr><td class="number">1.</td><td class="text">Start IISlockD.exe.</td></tr><tr><td class="number">2.</td><td class="text">Click <b>Advanced Lockdown</b>, and then click <b>Next</b>.</td></tr><tr><td class="number">3.</td><td class="text">The <b>Remove Script Mappings</b> dialog box is displayed
				<table class="list"><tr><td class="number">a. </td><td class="text">Click to clear the <strong class="uiterm">Disable support for Active
					 Server Pages (.asp)</strong> check box.</td></tr><tr><td class="number">b. </td><td class="text">If the <strong class="uiterm">Disable support for the .HTR scripting
					 (.htr)</strong> check box is selected, the OWA Change Password feature does not
					 function. Click <b>Next</b>.</td></tr></table></td></tr><tr><td class="number">4.</td><td class="text">The <b>Additional Lockdown Actions</b> dialog box is displayed.</td></tr><tr><td class="number">5.</td><td class="text">Click <b>Next</b>, and then click <b>Yes</b> to complete the lockdown process.</td></tr></table> If you already ran the IIS Lockdown tool against your Exchange
		  Server 5.5 OWA server with all of the options selected, to restore
		  functionality:
		  <table class="list"><tr><td class="bullet">•</td><td class="text">OWA:
				<table class="list"><tr><td class="number">1.</td><td class="text">Start Internet Services Manager.</td></tr><tr><td class="number">2.</td><td class="text">Click to expand the <b>Default Web Site</b>, right-click the Exchange virtual directory, and then click <b>Properties</b>.</td></tr><tr><td class="number">3.</td><td class="text">Click the <b>Virtual Directory</b> tab, and then click <b>Configuration</b>.</td></tr><tr><td class="number">4.</td><td class="text">Click the <b>.ASP</b> mapping, and then click <b>Edit</b>. The IIS Lockdown tool updates this mapping to 404.dll. Change
					 the mapping to asp.dll. On Microsoft Windows NT 4.0-based computers, add "PUT,
					 DELETE" to the <b>Method Exclusions</b> box. On Microsoft Windows 2000-based computers, make sure that
					 the <b>Limit to</b> check box is selected, and that the <b>Limit to</b> box contains "GET, HEAD, POST, TRACE".</td></tr><tr><td class="number">5.</td><td class="text">Click <b>OK</b> to close the properties.</td></tr></table></td></tr><tr><td class="bullet">•</td><td class="text">Change Password:
				<table class="list"><tr><td class="number">1.</td><td class="text">Re-create the Iisadmpwd virtual directory that was
					 deleted.For additional information about how to re-create the
						Iisadmpwd virtual directory, click the article number below to view the article
						in the Microsoft Knowledge Base: <div class="indent"><span><a class="KBlink" href="javascript:if(confirm('http://support.microsoft.com/kb/301428/EN-US/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/kb/301428/EN-US/'" tppabs="http://support.microsoft.com/kb/301428/EN-US/">301428</a></span> Troubleshooting Outlook Web Access from an IIS Perspective
</div></td></tr><tr><td class="number">2.</td><td class="text">By default, the mappings for ".htr" files are also
					 removed. Restore the mapping for ".htr" files:
					 <table class="list"><tr><td class="number">a. </td><td class="text">Start Internet Services Manager.</td></tr><tr><td class="number">b. </td><td class="text">Right-click the <b>Default Web Site</b>, and then click <b>Properties</b>.</td></tr><tr><td class="number">c. </td><td class="text">Click the <b>Home Directory</b> tab, and then click <b>Configuration</b>.</td></tr><tr><td class="number">d. </td><td class="text">Click the <b>.htr</b> mapping, and then click <b>Edit</b>. The IIS Lockdown tool updates this mapping to 404.dll. Change
						  the mapping to ism.dll.</td></tr><tr><td class="number">e. </td><td class="text">Click <b>OK</b> to close the properties.</td></tr></table></td></tr></table></td></tr></table><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="3"></a></span><a id="XSLTH3141121124120121120120"></a><h3>URLscan on Exchange 2000 Servers</h3>

For more information about using Exchange 2003 and URLscan , click the following article number to view the article in the Microsoft Knowledge Base:

<div class="indent"><span><a class="KBlink" href="javascript:if(confirm('http://support.microsoft.com/kb/823175/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/kb/823175/'" tppabs="http://support.microsoft.com/kb/823175/">823175</a></span>

 Fine-tuning and known issues when you use the Urlscan utility in an Exchange 2003 environment

</div>This section contains URLscan configuration files for the
		  following components:
		  <table class="list"><tr><td class="bullet">•</td><td class="text">OWA</td></tr><tr><td class="bullet">•</td><td class="text">Exchange System Manager</td></tr><tr><td class="bullet">•</td><td class="text">Instant Messaging</td></tr><tr><td class="bullet">•</td><td class="text">Web folders</td></tr></table> Please note that after you add the DenyUrlSequences section to
		  the URLScan.ini file, you may not be able to open mail messages via Outlook Web
		  Access (OWA) if the Subject line of the mail message contains these special
		  characters. Administrators should review the URLscan log file in
		  %windir%\system32\inetsrv\urslscan folder for assistance in resolving these
		  issues.<br><br> If multiple services are installed on a single server, you
		  need to merge the configuration files to ensure that all of the components
		  continue to function.<br><br> Open the Urlscan.ini file in the following
		  location: <div class="indent"><var>windir</var>\System32\Inetsrv\Urlscan
</div> Modify the Urlscan.ini file based on the Exchange computer
		  role.<br><br> If you encounter further difficulties when you attempt HTTP
		  requests with URLScan enabled, check the Urlscan.log file for the list of
		  requests that are being rejected. The default location of the Urlscan.log file
		  is: <div class="indent"><var>windir</var>\System32\Inetsrv\Urlscan
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="4"></a></span><a id="XSLTH4161121124120121120120"></a><h4>OWA</h4> The URLscan configuration file for OWA is as follows (if Change
		  Password functionality is required, you must remove the ".htr" file extension
		  from the Deny Extensions section): <div class="indent">
[Options]
<br>
UseAllowVerbs=1
<br>
UseAllowExtensions=0
<br>
NormalizeUrlBeforeScan=1
<br>
VerifyNormalization=1
<br>
AllowHighBitCharacters=1
<br>
AllowDotInPath=1
<br>
RemoveServerHeader=0
<br>
EnableLogging=1
<br>
PerProcessLogging=0
<br>
AllowLateScanning=0
<br><br>
[AllowVerbs]
<br>
GET
<br>
POST
<br>
SEARCH
<br>
POLL
<br>
PROPFIND
<br>
BMOVE
<br>
BCOPY
<br>
SUBSCRIBE
<br>
MOVE
<br>
PROPPATCH
<br>
BPROPPATCH
<br>
DELETE
<br>
BDELETE
<br>
MKCOL
<br><br>
[DenyVerbs]
<br><br>
[DenyHeaders]
<br>
If:
<br>
Lock-Token:
<br><br>

[DenyExtensions]
<br>
.asp
<br>
.cer
<br>
.cdx
<br>
.asa
<br>
.exe
<br>
.bat
<br>
.cmd
<br>
.com
<br>
.htw
<br>
.ida
<br>
.idq
<br>
.htr
<br>
.idc
<br>
.shtm
<br>
.shtml
<br>
.stm
<br>
.printer
<br>
.ini
<br>
.log
<br>
.pol
<br>
.dat
<br><br>
[DenyUrlSequences]
<br>
..
<br>
./
<br>
\
<br>
%
<br>
&amp;
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="5"></a></span><a id="XSLTH4166121124120121120120"></a><h4>Exchange System Manager for Public Folder Management</h4> The URLscan configuration file for Exchange System Manager
		  management of Public Folders is as follows: <div class="indent">
[Options]
<br>
UseAllowVerbs=1
<br>
UseAllowExtensions=0
<br>
NormalizeUrlBeforeScan=1
<br>
VerifyNormalization=1
<br>
AllowHighBitCharacters=1
<br>
AllowDotInPath=1
<br>
RemoveServerHeader=0
<br>
EnableLogging=1
<br>
PerProcessLogging=0
<br>
AllowLateScanning=0
<br><br>
[AllowVerbs]
<br>
PROPFIND
<br>
SEARCH
<br>
PROPPATCH
<br>
DELETE
<br>
MKCOL
<br>
MOVE
<br>
COPY
<br>
OPTIONS
<br><br>
[DenyVerbs]

<br><br>
[DenyHeaders]
<br>
If:
<br>
Lock-Token:
<br><br>
[DenyExtensions]
<br>
.asp
<br>
.cer
<br>
.cdx
<br>
.asa
<br>
.exe
<br>
.bat
<br>
.cmd
<br>
.htw
<br>
.ida
<br>
.idq
<br>
.htr
<br>
.idc
<br>
.shtm
<br>
.shtml
<br>
.stm
<br>
.printer
<br>
.ini
<br>
.log
<br>
.pol
<br>
.dat
</div><b>Note</b> You can add .com to the DENYEXTENSIONS list if internal Domain
		  Name System (DNS) does not contain .com. <div class="indent">

[DenyUrlSequences]
<br>
..
<br>
./
<br>
\
<br>
%
<br>
&amp;
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="6"></a></span><a id="XSLTH4174121124120121120120"></a><h4>Instant Messaging</h4> The URLscan configuration file for Instant Messaging is as
		  follows: <div class="indent">
[Options]
<br>
UseAllowVerbs=1
<br>
UseAllowExtensions=0
<br>
NormalizeUrlBeforeScan=1
<br>
VerifyNormalization=1
<br>
AllowHighBitCharacters=1
<br>
AllowDotInPath=1
<br>
RemoveServerHeader=0
<br>
EnableLogging=1
<br>
PerProcessLogging=0
<br>
AllowLateScanning=0
<br><br>
[AllowVerbs]
<br>
SUBSCRIBE
<br>
UNSUBSCRIBE
<br>
SUBSCRIPTIONS
<br>
NOTIFY
<br>
POLL
<br>
PROPFIND
<br>
PROPPATCH
<br>
ACL
<br><br>
[DenyVerbs]
<br><br>
[DenyHeaders]
<br>
If:
<br>
Lock-Token:
<br><br>
[DenyExtensions]
<br>
.asp
<br>
.cer
<br>
.cdx
<br>
.asa
<br>
.exe
<br>
.bat
<br>
.cmd
<br>
.com
<br>
.htw
<br>
.ida
<br>
.idq
<br>
.htr
<br>
.idc
<br>
.shtm
<br>
.shtml
<br>
.stm
<br>
.printer
<br>
.ini
<br>
.log

<br>
.pol
<br>
.dat
<br><br>
[DenyUrlSequences]
<br>
..
<br>
./
<br>
\
<br>
%
<br>
&amp;
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="7"></a></span><a id="XSLTH4179121124120121120120"></a><h4>Web Folders</h4> The URLscan configuration file for Web folders is as follows: <div class="indent">
[Options]
<br>
UseAllowVerbs=1

<br>
UseAllowExtensions=0
<br>
NormalizeUrlBeforeScan=1
<br>
VerifyNormalization=1
<br>
AllowHighBitCharacters=1
<br>
AllowDotInPath=1
<br>
RemoveServerHeader=0
<br>
EnableLogging=1
<br>
PerProcessLogging=0
<br>
AllowLateScanning=0
<br><br>
[AllowVerbs]
<br>
GET
<br>
PROPFIND
<br>
MOVE
<br>
BCOPY
<br>
DELETE
<br>
BDELETE
<br>
MKCOL
<br>
OPTIONS
<br>
LOCK
<br>
UNLOCK
<br>
PUT
<br><br>
[DenyVerbs]
<br><br>
[DenyHeaders]
<br>
Translate:
<br>
If:
<br>
Lock-Token:
<br><br>
[DenyExtensions]
<br>
.asp
<br>
.cer
<br>
.cdx
<br>
.asa
<br>
.exe
<br>
.bat
<br>
.cmd
<br>
.com
<br>
.htw
<br>
.ida
<br>
.idq
<br>
.htr
<br>
.idc
<br>
.shtm
<br>
.shtml
<br>
.stm
<br>
.printer
<br>
.ini
<br>
.log
<br>
.pol
<br>
.dat
<br><br>
[DenyUrlSequences]
<br>
..
<br>
:
<br>
./
<br>
\
<br>
%
<br>
&amp;
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="8"></a></span><a id="XSLTH4184121124120121120120"></a><h4>Custom WebDAV Programs</h4> You need to review any custom programs that were developed on the
		  Exchange 2000 store for the list of DAV verbs that are used. Add these verbs to
		  the AllowVerbs section of a URLscan configuration file and apply that file to
		  the servers that host the custom program.<br><br><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><span><a id="9"></a></span><a id="XSLTH3190121124120121120120"></a><h3>URLscan on Exchange Server 5.5 Computers</h3> Please note that after you add the DenyUrlSequences section to
		  the URLScan.ini file, you may not be able to open mail messages via Outlook Web
		  Access (OWA) if the Subject line of the mail message contains these special
		  characters. Administrators should review the URLscan log file in
		  %windir%\system32\inetsrv\urslscan folder for assistance in resolving these
		  issues.<br><br> The URLscan configuration file for OWA is as follows (if
		  Change Password functionality is required, you must remove the ".htr" file
		  extension from the Deny Extensions sections): <div class="indent">
[Options]<br>

UseAllowVerbs=1
<br>
UseAllowExtensions=0
<br>
NormalizeUrlBeforeScan=1
<br>
VerifyNormalization=1
<br>
AllowHighBitCharacters=1
<br>
AllowDotInPath=0
<br>
RemoveServerHeader=0
<br>
EnableLogging=1
<br>
PerProcessLogging=0
<br>
AllowLateScanning=0
<br>
AlternateServerName=
<br><br>
[AllowVerbs]
<br>
GET
<br>
HEAD
<br>
POST
<br><br>
[DenyVerbs]
<br>
PROPFIND
<br>
PROPPATCH
<br>
MKCOL
<br>
DELETE
<br>
PUT
<br>
COPY
<br>
MOVE
<br>
LOCK
<br>
UNLOCK
<br><br>
[DenyHeaders]
<br>
Translate:
<br>
If:
<br>
Lock-Token:
<br><br>
[DenyExtensions]
<br>
.exe
<br>
.bat
<br>
.cmd
<br>
.com
<br>
.htw
<br>
.ida
<br>
.idq
<br>
.idc
<br>
.shtm
<br>
.shtml
<br>
.stm
<br>
.printer
<br>
.ini
<br>
.log
<br>
.pol
<br>
.dat
<br>
.htr
<br><br>
[DenyUrlSequences]
<br>
..
<br>
./
<br>
\
<br>
:
<br>
%
<br>
&amp;
</div><span class="weboutput">
<A CLASS="LINK" HREF="#10">back to list of sections</A>
					</span><div class="topOfPage"><table><tr><td class="image"><a href="#toc"><img src="upArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/upArrow.gif" alt="Back to the top" title="Back to the top"></a></td><td class="text"><a href="#toc">Back to the top</a></td></tr></table></div></div></div><div class="appliesTo"><hr><a id="appliesto"></a><h5>APPLIES TO</h5><table class="list"><tr><td class="bullet">•</td><td class="text">Microsoft Exchange Server 2000 Service Pack 1</td></tr><tr><td class="bullet">•</td><td class="text">Microsoft Exchange Server 5.5 Standard Edition</td></tr><tr><td class="bullet">•</td><td class="text">Microsoft Exchange 2000 Enterprise Server</td></tr></table></div><div class="topOfPage"><table><tr><td class="image"><a href="#toc"><img src="upArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/upArrow.gif" alt="Back to the top" title="Back to the top"></a></td><td class="text"><a href="#toc">Back to the top</a></td></tr></table></div><div class="keywords"><table cellspacing="1"><tr><td class="header"><h5>Keywords: </h5></td><td class="text">kbprb KB309508 </td></tr></table><div class="topOfPage"><table><tr><td class="image"><a href="#toc"><img src="upArrow.gif" tppabs="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/upArrow.gif" alt="Back to the top" title="Back to the top"></a></td><td class="text"><a href="#toc">Back to the top</a></td></tr></table></div></div><div class="disclaimer"><div class="text"></div></div><!-- - -KB 3 end- - --></div></div></div></td><td class="primaryThinColumn"><div id="thinColumn" style="float: none;"><div class="wp articleTrans"><h1>Article Translations</h1><form name="frmArticleTrans" action="http://support.microsoft.com/" onsubmit="return SwitchLanguage();"><div><table cellpadding="0" cellspacing="0"><tr><td><select name="scid"><option value="kb;pt-br;309508">Brazilian</option><option value="kb;fr;309508">French</option><option value="kb;de;309508">German</option><option value="kb;it;309508">Italian</option><option value="kb;ja;309508">Japanese</option><option value="kb;ko;309508">Korean</option><option value="kb;pl;309508">Polish</option><option value="kb;zh-cn;309508">Simplified Chinese</option><option value="kb;es;309508">Spanish</option><option value="kb;zh-tw;309508">Traditional Chinese</option><option value="kb;tr;309508">Turkish</option></select></td><td class="spacer">&nbsp;</td><td><input type="image" alt="Translate the article" width="24" height="24" onmouseover="this.src='go_right_02-over.gif'/*tpa=http://support.microsoft.com/library/images/support/EN-US/go_right_02-over.gif*/;" onmouseout="this.src='GSSSM_rltlngRelatedlanguages.gif'/*tpa=http://support.microsoft.com/library/images/support/en-US/GSSSM_rltlngRelatedlanguages.gif*/;" src="GSSSM_rltlngRelatedlanguages.gif" tppabs="http://support.microsoft.com/library/images/support/en-US/GSSSM_rltlngRelatedlanguages.gif"><a id="KBLangListRedirect" href="" /></td></tr></table></div></form></div><div class="wp" id="RelatedSupportCenters"><table cellpadding="0" cellspacing="0"><tr><td class="textColumn"><h1>Related Support Centers</h1><table class="list" cellpadding="2" cellspacing="0"><tr class="er"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="bullet">&#149;</td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/?scid=ph;en-us;1776  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/?scid=ph;en-us;1776'" tppabs="http://support.microsoft.com/?scid=ph;en-us;1776" onclick="return MS_HandleClick(this,'29800', true);">Microsoft Exchange Server 5.5</a></td></tr></table></td></tr><tr class="or"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="bullet">&#149;</td><td class="text"><a href="-scid=ph;en-us;1760.htm" tppabs="http://support.microsoft.com/?scid=ph;en-us;1760" onclick="return MS_HandleClick(this,'29800', true);">Microsoft Exchange 2000 Server</a></td></tr></table></td></tr></table></td></tr></table></div><div class="wp" id="AdditionalResources"><table cellpadding="0" cellspacing="0"><tr><td class="textColumn"><h1>Other Support Options</h1><table class="list" cellpadding="2" cellspacing="0"><tr class="er" id="L_85573_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="bullet">&#149;</td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/contactus/?ws=support  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/contactus/?ws=support'" tppabs="http://support.microsoft.com/contactus/?ws=support" id="L_85573" title="Contact Microsoft" onclick="return MS_HandleClick(this,'29797', true);">Contact Microsoft</a><br>Phone Numbers, Support Options and Pricing, Online Help, and more.</td></tr></table></td></tr><tr class="or" id="L_85574_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="bullet">&#149;</td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/?scid=gp;[ln];csshome&style=home  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/?scid=gp;[ln];csshome&style=home'" tppabs="http://support.microsoft.com/?scid=gp;[ln];csshome&style=home" id="L_85574" title="Customer Service" onclick="return MS_HandleClick(this,'29797', true);">Customer Service</a><br>For non-technical assistance with product purchases, subscriptions, online services, events, training courses, corporate sales, piracy issues, and more.</td></tr></table></td></tr><tr class="er" id="L_85575_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="bullet">&#149;</td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/newsgroups/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/newsgroups/'" tppabs="http://support.microsoft.com/newsgroups/" id="L_85575" title="Newsgroups" onclick="return MS_HandleClick(this,'29797', true);">Newsgroups</a><br>Pose a question to other users. Discussion groups and Forums about specific Microsoft products, technologies, and services.</td></tr></table></td></tr></table></td></tr></table></div><div class="wp" id="SupportTools"><table cellpadding="0" cellspacing="0"><tr><td class="textColumn"><h1>Page Tools</h1><table class="list" cellpadding="2" cellspacing="0"><tr class="er" id="PrintPage_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="PrintPage_i" title="Print this page" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="Print this page" id="bi_PrintPage" src="printicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/printicon.gif"></a></td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="PrintPage" title="Print this page" onclick="return MS_HandleClick(this,'SupportTools', true);">Print this page</a></td></tr></table></td></tr><tr class="or" id="EmailPage_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="mailto:?subject=IIS%20lockdown%20and%20URLscan%20configurations%20in%20an%20Exchange%20environment&amp;body=http%3a%2f%2fsupport.microsoft.com%2fdefault.aspx%2fkb%2f309508%2f" id="EmailPage_i" title="E-mail this page" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="E-mail this page" id="bi_EmailPage" src="emailicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/emailicon.gif"></a></td><td class="text"><a href="mailto:?subject=IIS%20lockdown%20and%20URLscan%20configurations%20in%20an%20Exchange%20environment&amp;body=http%3a%2f%2fsupport.microsoft.com%2fdefault.aspx%2fkb%2f309508%2f" id="EmailPage" title="E-mail this page" onclick="return MS_HandleClick(this,'SupportTools', true);">E-mail this page</a></td></tr></table></td></tr><tr class="er" id="Worldwide_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="javascript:if(confirm('http://support.microsoft.com/common/international.aspx?rdPath=0  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/common/international.aspx?rdPath=0'" tppabs="http://support.microsoft.com/common/international.aspx?rdPath=0" id="Worldwide_i" title="Microsoft Worldwide" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="Microsoft Worldwide" id="bi_Worldwide" src="langicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/langicon.gif"></a></td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/common/international.aspx?rdPath=0  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/common/international.aspx?rdPath=0'" tppabs="http://support.microsoft.com/common/international.aspx?rdPath=0" id="Worldwide" title="Microsoft Worldwide" onclick="return MS_HandleClick(this,'SupportTools', true);">Microsoft Worldwide</a></td></tr></table></td></tr><tr class="or" id="SaveToMySupportFavorites_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="SaveToMySupportFavorites_i" title="Save to My Support Favorites" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="Save to My Support Favorites" id="bi_SaveToMySupportFavorites" src="saveicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/saveicon.gif"></a></td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="SaveToMySupportFavorites" title="Save to My Support Favorites" onclick="return MS_HandleClick(this,'SupportTools', true);">Save to My Support Favorites</a></td></tr></table></td></tr><tr class="er" id="MySupportFavoritesLink_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="MySupportFavoritesLink_i" title="Go to My Support Favorites" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="Go to My Support Favorites" id="bi_MySupportFavoritesLink" src="gotoicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/gotoicon.gif"></a></td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="MySupportFavoritesLink" title="Go to My Support Favorites" onclick="return MS_HandleClick(this,'SupportTools', true);">Go to My Support Favorites</a></td></tr></table></td></tr><tr class="or" id="SendFeedback_tr"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="image"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="SendFeedback_i" target="_blank" title="Send Feedback" onclick="return MS_HandleClick(this,'SupportTools', true);"><img alt="Send Feedback" id="bi_SendFeedback" src="sendicon.gif" tppabs="http://support.microsoft.com/library/images/support/cn/sendicon.gif"></a></td><td class="text"><a href="javascript:if(confirm('http://support.microsoft.com/gp/noscript/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/gp/noscript/'" tppabs="http://support.microsoft.com/gp/noscript/" id="SendFeedback" target="_blank" title="Send Feedback" onclick="return MS_HandleClick(this,'SupportTools', true);">Send Feedback</a></td></tr></table></td></tr><tr class="er"><td class="lc0"><table class="innerTable" cellpadding="0" cellspacing="0"><tr><td class="text"><div class="center"><a href="javascript:if(confirm('https://profile.microsoft.com/RegSysProfileCenter/wizard.aspx?wizid=6182013c-7c1f-40a3-99ae-27651c3668aa&lcid=1033&fu=%2fdefault.aspx%2fkb%2f309508%2f&brand=Microsoft  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?'))window.location='https://profile.microsoft.com/RegSysProfileCenter/wizard.aspx?wizid=6182013c-7c1f-40a3-99ae-27651c3668aa&lcid=1033&fu=%2fdefault.aspx%2fkb%2f309508%2f&brand=Microsoft'" tppabs="https://profile.microsoft.com/RegSysProfileCenter/wizard.aspx?wizid=6182013c-7c1f-40a3-99ae-27651c3668aa&lcid=1033&fu=%2fdefault.aspx%2fkb%2f309508%2f&brand=Microsoft"><IMG SRC="signin.gif" tppabs="http://www.passportimages.com/1033/signin.gif" CLASS="PassportSignIn" BORDER="0" ALT="Sign in to the Microsoft Passport Network" ID="idSI"/></A></div></td></tr></table></td></tr></table></td></tr></table></div></div></td></tr></table></div></div><div id="widthFix"></div></div></XMLREADER></td></tr></table><br clear="all" style="line-height: 1px; overflow: hidden"><table id="msviFooter" width="100%" cellpadding="0" cellspacing="0"><tr valign="bottom"><td id="msviFooter2" style="filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#3F8CDA', gradientType='1')"><div id="msviLocalFooter"><nobr><a href="javascript:if(confirm('http://go.microsoft.com/?linkid=317027  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://go.microsoft.com/?linkid=317027'" tppabs="http://go.microsoft.com/?linkid=317027">Manage Your Profile</a> |</nobr><wbr><nobr><a href="javascript:if(confirm('http://support.microsoft.com/contactus/?ws=support  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/contactus/?ws=support'" tppabs="http://support.microsoft.com/contactus/?ws=support" target="_parent">Contact Us</a></nobr></div><div id="msviGlobalFooter"><span dir="ltr">&#169;2005 Microsoft Corporation. All rights reserved.&nbsp;</span><nobr><a href="javascript:if(confirm('http://support.microsoft.com/tou/  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/tou/'" tppabs="http://support.microsoft.com/tou/">Terms of Use</a> |</nobr><wbr><nobr><a href="javascript:if(confirm('http://support.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://support.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx'" tppabs="http://support.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</a> |</nobr><wbr><nobr><a href="index-2.htm" tppabs="http://support.microsoft.com/privacy/">Privacy Statement</a></nobr></div></td></tr></table><img id="webmetriximg" alt="" src="onepix.gif" tppabs="http://support.microsoft.com/library/images/support/cn/onepix.gif"><noscript><img id="StatsDotNetImgNoScript" alt="" src="default.aspx-SSID=1&#38;SiteLCID=1033&#38;EventCollectionID=1&#38;URL=%2fdefault.aspx&#38;ContentType=kb&#38;ContentLCID=1033&#38;ContentID=309508&#38;BrandID=1&#38;" tppabs="http://support.microsoft.com/LTS/default.aspx?SSID=1&#38;SiteLCID=1033&#38;EventCollectionID=1&#38;URL=%2fdefault.aspx&#38;ContentType=kb&#38;ContentLCID=1033&#38;ContentID=309508&#38;BrandID=1&#38;"></noscript><img id="StatsDotNetImg" name="StatsDotNetImg" alt="" src="onepix.gif" tppabs="http://support.microsoft.com/library/images/support/cn/onepix.gif" /><script type="text/javascript">StatsDotNet.disabled=false;StatsDotNet.host='http://support.microsoft.com/kb/309508/http/x3a/x2f/x2fsupport.microsoft.com/x2fLTS/x2fdefault.aspx';StatsDotNet.ssId='1';StatsDotNet.siteLcId='1033';StatsDotNet.url='http://support.microsoft.com/x2fdefault.aspx';StatsDotNet.contentType='kb';StatsDotNet.contentLn='1033';StatsDotNet.contentId='309508';StatsDotNet.eventCollectionId=1;StatsDotNet.siteBrandId='1';StatsDotNet.onUnloadTimeout=300;</script><script type="text/javascript">function thisLoad(){MS_WebMetrix('http://support.microsoft.com/kb/309508/http/x3a/x2f/x2fc.microsoft.com/x2ftrans_pixel.asp/x3fTYPE/x3dSSPV/x26SOURCE/x3dSUPPORT/x26GUID/x3d1F4FC18C-F71E-47fb-8FC9-612F8EE59C61/x26URI/x3d/x252fgn/x252fen-us/x252fkb_en-us_309508/x26R/x3dhttp/x253a/x252f/x252fsupport.microsoft.com');StatsDotNet.LogPageOnLoad();g_reSupportedHostnames = new RegExp("\\.microsoft\\.com$|\\.passport\\.com$", "i");ForeignLink_Hookup(true);MNPResizeFix();}function thisUnload(){}</script></body></html>