<html><head>
<title>Solution for /geometry/points.in.sphere</title></head>
<body bgcolor="#FFFFFF">
<h1>Solution to the /geometry/points.in.sphere problem</h1>
<hr>
Use spherical polar coordinates, and w.l.o.g. choose the polar axis
through one of the points. Now the distance between the two points is
<pre>
     sqrt ( r1^2 + r2^2 - 2 r1 r2 cos(theta))
</pre>

and cos(theta) is (conveniently) uniformly distributed between -1 and
+1, while r1 and r2 have densities 3 r1^2 d(r1) and 3 r2^2 d(r2). Split
the total integral into two (equal) parts with r1 &lt; r2 and r1 &gt; r2, and
it all comes down to integrating polynomials.

More generally, the expectation of the n'th power of the distance
between the two points is
<pre>
     2^n . 72 / ((n+3)(n+4)(n+6))
</pre>

So the various means are:
<pre>
     the (arithmetic) mean distance is  36/35      = 1.028571...
     the root mean square distance is   sqrt(6/5)  = 1.095445...
     the geometric mean distance is     2exp(-3/4) = 0.944733...
     the harmonic mean distance is      5/6        = 0.833333...
     the inverse root mean inverse square distance is
                                        2/3        = 0.666666...
</pre>
<br>
<br>
<center>
<a href="mailto:nospam+4@rec-puzzles.org">E-mail</a> |
<a href="index-1.htm" tppabs="http://rec-puzzles.org/">to the index</a> |
<a href="javascript:if(confirm('http://ladybug.xs4all.nl/arlet/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ladybug.xs4all.nl/arlet/'" tppabs="http://ladybug.xs4all.nl/arlet/">to Arlet's home page</a> |
Powered by  
<a href="javascript:if(confirm('http://www.linux.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.linux.org/'" tppabs="http://www.linux.org/">Linux</a>/<a href="javascript:if(confirm('http://www.apache.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.apache.org/'" tppabs="http://www.apache.org/">Apache</a>.
</center>
<br>
<hr>
<em>
... ``follow me,'' the wise man said, but he walked behind... </em><br>
</body></html>