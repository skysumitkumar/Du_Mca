<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>Nick's Mathematical Puzzles: Solution 94</title>
<meta name="Description" content="Number theory puzzle solution: Square endings" />
<meta name="Keywords" content="number theory,automorphic,Chinese remainder theorem,modulo,mathematical puzzle" /><link rel="stylesheet" href="puzz4.css" tppabs="http://www.qbyte.org/puzzles/puzz4.css" type="text/css" /><link rel="shortcut icon" href="javascript:if(confirm('http://www.qbyte.org/favicon.ico  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/favicon.ico'" tppabs="http://www.qbyte.org/favicon.ico" /><style type="text/css">.di{margin-top:-.9em}</style></head>
<body><div class="e">
<div class="m"><a href="#main"><img src="s.gif" tppabs="http://www.qbyte.org/puzzles/s.gif" alt="Skip to main content." height="1" width="1" /></a><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div>
<h1 id="main">Solution to puzzle 94: Square endings</h1>
<p>Find all 8-digit natural numbers n such that n<sup>2</sup> ends in the same 8 digits as n.&nbsp; Numbers are written in standard decimal notation, with no leading zeroes.</p><hr />
<p>Numbers with this property are called <em>automorphic</em>.</p>
<h2>Find 2-digit automorphic numbers</h2>
<p>We begin by finding all 2-digit automorphic numbers: consider n<sup>2</sup> - n = n(n - 1) <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 (mod 100).<br />
Since n is a 2-digit number, neither n nor n - 1 is divisible by 100.<br />
Therefore, since n and n - 1 are <a href="javascript:if(confirm('http://en.wikipedia.org/wiki/Coprime  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://en.wikipedia.org/wiki/Coprime'" tppabs="http://en.wikipedia.org/wiki/Coprime">coprime</a>, one or both of the following must hold:</p>
<p class="i">n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 (mod 2<sup>2</sup>)<br />
n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 1 (mod 5<sup>2</sup>)&nbsp; <span class="i">(1)</span></p>
<p class="i"><span class="i">or</span></p>
<p class="i">n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 1 (mod 2<sup>2</sup>)<br />
n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 (mod 5<sup>2</sup>)&nbsp; <span class="i">(2)</span></p>
<p>From (1), we have n = 1 + 25r, for some integer r, and so 1 + 25r <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 1 + r <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 (mod 4.)<br />
Hence r <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 3 (mod 4), and n = 1 + 25(3 + 4s) = 76 + 100s, for some integer s.<br />
Therefore n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 76 (mod 100.)</p>
<p>Similarly, from (2) we obtain n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 25 (mod 100.)</p>
<p>Note that for k-digit automorphic numbers, where k &gt; 1, equations (1) and (2) hold modulo 2<sup>k</sup> and modulo 5<sup>k</sup>.&nbsp; The <a href="javascript:if(confirm('http://www.cut-the-knot.org/blue/chinese.shtml  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.cut-the-knot.org/blue/chinese.shtml'" tppabs="http://www.cut-the-knot.org/blue/chinese.shtml">Chinese Remainder Theorem</a> guarantees that each set of equations has a unique solution, modulo 10<sup>k</sup>.&nbsp; Hence there is always precisely one automorphic number ending in 5, and one ending in 6, subject to the caveat that each number may have one or more leading zeroes.</p>
<h2>Establish a recurrence relation</h2>
<p>We could apply the above method directly to 8-digit numbers.&nbsp; However, we know that an 8-digit automorphic number must end in 76 or 25.&nbsp; Can we make use of this fact algebraically?</p>
<p>For k &gt; 0, let a<sub>k</sub> be an automorphic number with k digits.&nbsp; That is, a<sub>k</sub><sup>2</sup> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> a<sub>k</sub> (mod 10<sup>k</sup>.)<br />
Suppose a<sub>2k</sub> = 10<sup>k</sup>n + a<sub>k</sub> is automorphic, so that (10<sup>k</sup>n + a<sub>k</sub>)<sup>2</sup> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 10<sup>k</sup>n + a<sub>k</sub> (mod 10<sup>2k</sup>.)<br />
We seek to express n in terms of a<sub>k</sub>.</p>
<p>Expanding, we obtain 2&times;10<sup>k</sup>a<sub>k </sub>n + a<sub>k</sub><sup>2</sup> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 10<sup>k</sup>n + a<sub>k</sub> (mod 10<sup>2k</sup>.)<br />
Simplifying, 10<sup>k</sup>(2a<sub>k</sub> - 1)n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> a<sub>k</sub> - a<sub>k</sub><sup>2</sup> (mod 10<sup>2k</sup>.)<br />
As both sides of this equation, and the modulus itself, are divisible by 10<sup>k</sup>, we may divide by that quantity, obtaining<br />
<span class="i">(2a<sub>k</sub> - 1)n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (a<sub>k</sub> - a<sub>k</sub><sup>2</sup>)/10<sup>k</sup> (mod 10<sup>k</sup>)&nbsp; <span class="i">(3)</span></span></p>
<p>Now note that 2a<sub>k</sub> - 1 is coprime with 10<sup>k</sup>.<br />
(This follows because 2a<sub>k</sub> - 1 is odd, and, since a<sub>k</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 or 1 (mod 5), 2a<sub>k</sub> - 1 is not divisible by 5.)<br />
Hence (3) has precisely one solution for n.</p>
<p>Now multiply (3) by 2a<sub>k</sub> - 1.<br />
Noting that 4(a<sub>k</sub><sup>2</sup> - a<sub>k</sub>) <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> 0 (mod 10<sup>k</sup>), we obtain<br />
<span class="i">n <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (2a<sub>k</sub> - 1)(a<sub>k</sub> - a<sub>k</sub><sup>2</sup>)/10<sup>k</sup> (mod 10<sup>k</sup>.)</span></p>
<p>This gives us the following <a href="javascript:if(confirm('http://en.wikipedia.org/wiki/Recurrence  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://en.wikipedia.org/wiki/Recurrence'" tppabs="http://en.wikipedia.org/wiki/Recurrence">recurrence relation</a>:<br />
<span class="i">a<sub>2k</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> a<sub>k</sub> + 10<sup>k</sup>[(2a<sub>k</sub> - 1)(a<sub>k</sub> - a<sub>k</sub><sup>2</sup>)/10<sup>k</sup> (mod 10<sup>k</sup>)]</span></p>
<p>Since s &times; [r (mod s)] <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> sr (mod s<sup>2</sup>), this simplifies to</p>
<table class="i di"><tr><td>a<sub>2k</sub>&nbsp;</td><td> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> a<sub>k</sub> + (2a<sub>k</sub> - 1)(a<sub>k</sub> - a<sub>k</sub><sup>2</sup>) (mod 10<sup>2k</sup>)</td></tr>
<tr><td>&nbsp;</td><td> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> a<sub>k</sub> + (3a<sub>k</sub><sup>2</sup> - 2a<sub>k</sub><sup>3</sup> - a<sub>k</sub>) (mod 10<sup>2k</sup>)</td></tr>
<tr><td>&nbsp;</td><td> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (3a<sub>k</sub><sup>2</sup> - 2a<sub>k</sub><sup>3</sup>) (mod 10<sup>2k</sup>), since a<sub>k</sub> &lt; 10<sup>2k</sup></td></tr></table>
<p>Letting a<sub>2</sub> = 76,&nbsp; a<sub>4</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (3&times;76<sup>2</sup> - 2&times;76<sup>3</sup>) (mod 10<sup>4</sup>) = 9376.<br />
Then a<sub>8</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (3&times;9376<sup>2</sup> - 2&times;9376<sup>3</sup>) (mod 10<sup>8</sup>) = 87109376.</p>
<p>Letting a<sub>2</sub> = 25,&nbsp; a<sub>4</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (3&times;25<sup>2</sup> - 2&times;25<sup>3</sup>) (mod 10<sup>4</sup>) = 0625.<br />
Then a<sub>8</sub> <img src="equ.gif" tppabs="http://www.qbyte.org/puzzles/equ.gif" width="10" height="9" alt="congruent to" /> (3&times;625<sup>2</sup> - 2&times;625<sup>3</sup>) (mod 10<sup>8</sup>) = 12890625.</p>
<p>Hence, the only 8-digit natural numbers n such that n<sup>2</sup> ends in the same 8 digits as n, are 12890625 and 87109376.</p>
<hr /><h2 class="h3">Further reading</h2>
<ol><li><a href="javascript:if(confirm('http://en.wikipedia.org/wiki/Automorphic_number  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://en.wikipedia.org/wiki/Automorphic_number'" tppabs="http://en.wikipedia.org/wiki/Automorphic_number">Automorphic number (1)</a></li><li><a href="javascript:if(confirm('http://mathworld.wolfram.com/AutomorphicNumber.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mathworld.wolfram.com/AutomorphicNumber.html'" tppabs="http://mathworld.wolfram.com/AutomorphicNumber.html">Automorphic number (2)</a></li>
<li><a href="javascript:if(confirm('http://www.wschnei.de/digit-related-numbers/automorphic-numbers.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.wschnei.de/digit-related-numbers/automorphic-numbers.html'" tppabs="http://www.wschnei.de/digit-related-numbers/automorphic-numbers.html">Automorphic numbers</a></li></ol>
<p class="c"><cite>Source: Traditional</cite></p>
<div id="n" class="m"><ul><li>Puzzles: </li><li><a href="puzzle01.html" tppabs="http://www.qbyte.org/puzzles/puzzle01.html">1-10</a> </li><li><a href="puzzle02.html" tppabs="http://www.qbyte.org/puzzles/puzzle02.html">11-20</a> </li><li><a href="puzzle03.html" tppabs="http://www.qbyte.org/puzzles/puzzle03.html">21-30</a> </li><li><a href="puzzle04.html" tppabs="http://www.qbyte.org/puzzles/puzzle04.html">31-40</a> </li><li><a href="puzzle05.html" tppabs="http://www.qbyte.org/puzzles/puzzle05.html">41-50</a> </li><li><a href="puzzle06.html" tppabs="http://www.qbyte.org/puzzles/puzzle06.html">51-60</a> </li><li><a href="puzzle07.html" tppabs="http://www.qbyte.org/puzzles/puzzle07.html">61-70</a> </li><li><a href="puzzle08.html" tppabs="http://www.qbyte.org/puzzles/puzzle08.html">71-80</a> </li><li><a href="puzzle09.html" tppabs="http://www.qbyte.org/puzzles/puzzle09.html">81-90</a> </li><li><a href="puzzle10.html" tppabs="http://www.qbyte.org/puzzles/puzzle10.html">91-100</a> </li><li><a href="puzzle11.html" tppabs="http://www.qbyte.org/puzzles/puzzle11.html">101-110</a> </li><li><a href="puzzle12.html" tppabs="http://www.qbyte.org/puzzles/puzzle12.html">111-120</a> </li><li><a href="puzzle99.html" tppabs="http://www.qbyte.org/puzzles/puzzle99.html">Index</a> </li><li>| </li><li><a href="javascript:if(confirm('http://www.qbyte.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qbyte.org/'" tppabs="http://www.qbyte.org/">Home</a> </li><li><a href="index.htm" tppabs="http://www.qbyte.org/puzzles/">About</a> </li><li><a href="accessibility.html" tppabs="http://www.qbyte.org/puzzles/accessibility.html">Accessibility</a></li></ul></div></div></body></html>