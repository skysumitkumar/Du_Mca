
<!--Converted with LaTeX2HTML 2K.1beta (1.47)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Solutions for Questions&nbsp;5 (page ).</TITLE>
<META NAME="description" CONTENT="Solutions for Questions&nbsp;5 (page ).">
<META NAME="keywords" CONTENT="notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<!--#include virtual="/maths/department/include_html/style1.html"-->
<!--#include
    virtual="/maths/department/include_html/head.html"-->

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="notes.css" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/notes.css">

<LINK REL="next" HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">
<LINK REL="previous" HREF="node109.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node109.html">
<LINK REL="up" HREF="node103.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node103.html">
<LINK REL="next" HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">
</HEAD>

<BODY  bgcolor="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html1918"
  HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/next.gif"></A> 
<A NAME="tex2html1912"
  HREF="node103.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node103.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/up.gif"></A> 
<A NAME="tex2html1906"
  HREF="node109.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node109.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/prev.gif"></A> 
<A NAME="tex2html1914"
  HREF="node1.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/contents.gif"></A> 
<A NAME="tex2html1916"
  HREF="node113.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node113.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/index.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1919"
  HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">Solutions for Questions&nbsp;6 (page</A>
<B> Up:</B> <A NAME="tex2html1913"
  HREF="node103.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node103.html">Appendices</A>
<B> Previous:</B> <A NAME="tex2html1907"
  HREF="node109.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node109.html">Solutions for Questions&nbsp;4 (page</A>
 &nbsp <B>  <A NAME="tex2html1915"
  HREF="node1.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html1917"
  HREF="node113.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node113.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION001170000000000000000"></A><A NAME="SA:random"></A>
<BR>
Solutions for Questions&nbsp;<A HREF="node87.html#SQ:random" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#SQ:random">5</A> (page <A HREF="node87.html#SQ:random" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#SQ:random"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/crossref.gif"></A>).
</H1>

<P>
<I>Solution</I> <A HREF="node87.html#Q:periodic" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:periodic">5.1</A>:<A NAME="A:periodic"></A>Since <I>X</I> is finite, the set <!-- MATH
 $\{x_i \in X \mid i = 0,1,2,\ldots\}$
 -->
{<I>x</I><SUB>i</SUB> <IMG
 WIDTH="15" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img65.gif"
 ALT="$ \in$"> <I>X</I> | <I>i</I> = 0, 1, 2,...} is
itslef finite, and so there must be some pair <I>i</I>, <I>j</I> &gt; 0 such that <!-- MATH
 $x_i
= x_{i+j}$
 -->
<I>x</I><SUB>i</SUB> = <I>x</I><SUB>i + j</SUB>.  Choose the least such <I>i</I> for which this holds, and then
choose the least such <I>j</I>.  Then <!-- MATH
 $x_{i+j+1} = \phi{x_i+j} = \phi{x_i}
= x={i+1}$
 -->
<I>x</I><SUB>i + j + 1</SUB> = <IMG
 WIDTH="14" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img77.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img77.gif"
 ALT="$ \phi$"><I>x</I><SUB>i</SUB>+<I>j</I> = <IMG
 WIDTH="14" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img77.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img77.gif"
 ALT="$ \phi$"><I>x</I><SUB>i</SUB> = <I>x</I> = <I>i</I>+1 etc and the sequence is periodic of period <I>j</I> starting at
<I>x</I><SUB>i</SUB>.
<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:random-points" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:random-points">5.2</A>:<A NAME="A:random-points"></A>There are several ways of getting a point ``at random'' in <I>T</I><SUB>1</SUB>; we
look at them in turn.  The most straightforward is to choose <!-- MATH
 $x =
\text{RAND}$
 -->
<I>x</I> = RAND and <!-- MATH
 $y = \text{RAND}$
 -->
<I>y</I> = RAND, and then throw away the points not
in <I>T</I><SUB>1</SUB>.  This has the disadvantage that we throw away half of the
points chosen.  A quicker method depends on the fact that the line
<I>y</I> = <I>x</I> divides the square into two congruent triangles, and so accepts
(<I>x</I>, <I>y</I>) if it lies in <I>T</I><SUB>1</SUB> and otherwise accepts the point (<I>y</I>, <I>x</I>),
which necessarily lies in <I>T</I><SUB>1</SUB>, if (<I>x</I>, <I>y</I>) does not (unless <I>x</I> = <I>y</I>,
which we ignore, or throw away).

<P>
A third way can generalise a little more easily.  First let <!-- MATH
 $t =
\text{RAND}$
 -->
<I>t</I> = RAND, write <!-- MATH
 $x = \sqrt{t}$
 -->
<I>x</I> = <IMG
 WIDTH="23" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img445.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img445.gif"
 ALT="$ \sqrt{t}$">, choose <!-- MATH
 $y=\text{RAND}[0,x)$
 -->
<I>y</I> = RAND[0, <I>x</I>) and
choose the point (<I>x</I>, <I>y</I>).  Clearly the chosen point lies in <I>T</I><SUB>1</SUB>; we
have to show that this gives a random distribution.  Given <I>x</I>, it is
clear that <I>y</I> is chosen with uniform probability; we must thus show
that <I>x</I> was chosen appropriately.  In other words,
that the probability <I>dp</I> of choosing a point in a strip of width <I>dx</I>
at the point <I>x</I> is proportional to <I>x</I>&nbsp;<I>dx</I>, the area of the strip.
Thus
<!-- MATH
 \begin{displaymath}
dp = k x \, dx, \quad\text{and so } p = kx^2/2 = Kt.
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<I>dp</I> = <I>kx</I>&nbsp;<I>dx</I>,&nbsp;&nbsp;&nbsp;&nbsp;and so<I>p</I> = <I>kx</I><SUP>2</SUP>/2 = <I>Kt</I>.
</DIV><P></P>
Thus the probability is uniform, as required.

<P>
It is clear that the same arguments apply to choosing a point in
<I>T</I><SUB>2</SUB>.

<P>
We now analyse ways of producing points in <I>T</I><SUB>3</SUB>.  It is clear that
Method&nbsp;1 produces points chosen at random in <I>T</I><SUB>3</SUB>.

<P>
Method&nbsp;2 is like Method&nbsp;1, except that before the third call to
<!-- MATH
 $\text{RAND}()$
 -->
RAND(), a check is made that <!-- MATH
 $(x,y) \in T_2$
 -->
(<I>x</I>, <I>y</I>) <IMG
 WIDTH="15" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img65.gif"
 ALT="$ \in$"> <I>T</I><SUB>2</SUB>, and the process
abandoned if it is not.  Clearly we can ommit a call to
<!-- MATH
 $\text{RAND}()$
 -->
RAND() without affecting the outcome, if we know in advance
that nothing will be produced.  Thus this method <I>does</I> produce
random points of <I>T</I><SUB>2</SUB>.

<P>
Note that Method&nbsp;3 and Method&nbsp;4 are effectively the same, although
Method&nbsp;4 is quicker; in each case, having picked (<I>x</I>, <I>y</I>) at random in
<I>T</I><SUB>2</SUB>, we wait until some <I>z</I> with <!-- MATH
 $0 \le z < 1-x-y$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>z</I> &lt; 1 - <I>x</I> - <I>y</I> has been chosen
before making another choice of (<I>x</I>, <I>y</I>).  In particular, we see that
the probability of a point lying in
<!-- MATH
 \begin{displaymath}
\{(x,y,z) \mid (x_0 \le x \le x_0 + dx,y_0 \le y \le y_0 + dy,0 \le z
\le 1 - x_0 - y_0)\}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
{(<I>x</I>, <I>y</I>, <I>z</I>) | (<I>x</I><SUB>0</SUB><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>x</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>x</I><SUB>0</SUB> + <I>dx</I>, <I>y</I><SUB>0</SUB><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>y</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>y</I><SUB>0</SUB> + <I>dy</I>, 0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>z</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$">1 - <I>x</I><SUB>0</SUB> - <I>y</I><SUB>0</SUB>)}
</DIV><P></P>
is proportional to <I>dx</I>&nbsp;<I>dy</I>, rather than <!-- MATH
 $(1 - x_0 - y_0)\,dx\,dy$
 -->
(1 - <I>x</I><SUB>0</SUB> - <I>y</I><SUB>0</SUB>)&nbsp;<I>dx</I>&nbsp;<I>dy</I> as
it should do if equal volumes are equally likely.

<P>
<B>Random points in <I>T</I><SUB>4</SUB>:</B> the triangle in question is
equilateral, with side <IMG
 WIDTH="25" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img2.gif"
 ALT="$ \sqrt{2}$">.  We first show how to pick a point
at random from the equilateral triangle <I>T</I> with vertices (- 1, 0),
(0, 1) and (1, 0) whose side is of length 2, and then construct an
affine map to the requierd triangle.

<P>
To choose a point at random in <I>T</I>, pick <!-- MATH
 $x = \text{RAND}()$
 -->
<I>x</I> = RAND() and <!-- MATH
 $y =
2*\text{RAND}()$
 -->
<I>y</I> = 2*RAND().  If <!-- MATH
 $(x,y) \in T$
 -->
(<I>x</I>, <I>y</I>) <IMG
 WIDTH="15" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img65.gif"
 ALT="$ \in$"> <I>T</I>, accept it; otherwise choose
<!-- MATH
 $(-x,2-y) \in T$
 -->
(- <I>x</I>, 2 - <I>y</I>) <IMG
 WIDTH="15" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img65.gif"
 ALT="$ \in$"> <I>T</I>.  This is essentially the same idea as in choosing a
point of <I>T</I><SUB>1</SUB>.

<P>
There will be a unique affine map to <I>T</I><SUB>4</SUB>.  A calculation shows it is
<!-- MATH
 \begin{displaymath}
(x,y) \longrightarrow \left(
	-\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
	\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
	\frac{1}{1}y\right)
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
(<I>x</I>, <I>y</I>) <IMG
 WIDTH="30" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img446.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img446.gif"
 ALT="$\displaystyle \longrightarrow$"> <IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img447.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img447.gif"
 ALT="$\displaystyle \left(\vphantom{
-\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
\frac{1}{1}y}\right.$"> - <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img43.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{2}}$"><I>x</I> - <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img45.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{4}}$"><I>y</I> + <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img43.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{2}}$">,<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img43.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{2}}$"><I>x</I> - <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img45.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{4}}$"><I>y</I> + <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img43.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{2}}$">,<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img448.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img448.gif"
 ALT="$\displaystyle {\textstyle\frac{1}{1}}$"><I>y</I><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img449.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img449.gif"
 ALT="$\displaystyle \left.\vphantom{
-\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
\frac{1}{2}x - \frac{1}{4}y + \frac{1}{2},
\frac{1}{1}y}\right)$">
</DIV><P></P>
is the rquired map.

<P>
A less efficient, and <I>incorrect</I> way picks <I>x'</I>, <I>y'</I> and <I>z'</I>
using <!-- MATH
 $\text{RAND}()$
 -->
RAND(), so necessarily equally distributed random
variables with <!-- MATH
 $0 \le x',y',z'< 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>x'</I>, <I>y'</I>, <I>z'</I> &lt; 1, and then use variables
<!-- MATH
 \begin{displaymath}
\     x=\frac{x'}{x' + y' + z'},\qquad
\     y=\frac{y'}{x' + y' + z'},\qquad
\     z=\frac{z'}{x' + y' + z'}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<I>x</I> = <IMG
 WIDTH="86" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img450.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img450.gif"
 ALT="$\displaystyle {\frac{x'}{x' + y' + z'}}$">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<I>y</I> = <IMG
 WIDTH="86" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img451.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img451.gif"
 ALT="$\displaystyle {\frac{y'}{x' + y' + z'}}$">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<I>z</I> = <IMG
 WIDTH="86" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img452.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img452.gif"
 ALT="$\displaystyle {\frac{z'}{x' + y' + z'}}$">
</DIV><P></P>
Again we have  <!-- MATH
 $0 \le x',y',z'< 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>x'</I>, <I>y'</I>, <I>z'</I> &lt; 1 equally distributed with <!-- MATH
 $0 \le x,y,z<
1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>x</I>, <I>y</I>, <I>z</I> &lt; 1 and they satisfy the required constraint.  This amounts to choosing
a point in the unit cube, and projecting onto the plane <!-- MATH
 $x + y + z =
0$
 -->
<I>x</I> + <I>y</I> + <I>z</I> = 0.  It is now clear that there is a problem; the probability of
picking a given point is proportional to the length of the line from
the origin, through the point, to the edge of the unit cube, which can
vary from 1, at a vertx to <IMG
 WIDTH="25" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img453.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img453.gif"
 ALT="$ \sqrt{3}$"> along the main diagonal.
<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:random-on-earth" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:random-on-earth">5.3</A>:<A NAME="A:random-on-earth"></A>Assume the earth is a sphere of radius <I>R</I>, and that latitude and
longitude are chosen at random.  The area in which the point can lie
if the latitude is between 0 and a very small angle <!-- MATH
 $d\vartheta$
 -->
<I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$"> is
approximately the area of a cylinder of radius <I>R</I> and height
<!-- MATH
 $R\,d\vartheta$
 -->
<I>R</I>&nbsp;<I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">, and so has area <!-- MATH
 $2\pi R^2\,d\vartheta$
 -->
2<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$"><I>R</I><SUP>2</SUP>&nbsp;<I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">.  An equally
likely choice is that the latitude lies between <!-- MATH
 $\pi/2-d\vartheta$
 -->
<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">/2 - <I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$"> and
<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">/2, in which case the chosen point lies in an approximately
circular arc of radius <!-- MATH
 $R\,d\vartheta$
 -->
<I>R</I>&nbsp;<I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">, with area
<!-- MATH
 $\pi R^2(d\vartheta)^2$
 -->
<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$"><I>R</I><SUP>2</SUP>(<I>d</I><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">)<SUP>2</SUP>.  Theses are very different; thus the choice
thus does not lead to an equal probability of choosing points near the
pole, and near the equator.

<P>
An easy way to choose points from the ball <!-- MATH
 $x^2 + y^2 + z^2 \le 1$
 -->
<I>x</I><SUP>2</SUP> + <I>y</I><SUP>2</SUP> + <I>z</I><SUP>2</SUP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1 is
to choose each of <I>x</I>, <I>y</I> and <I>z</I> from <!-- MATH
 $\text{RAND}(-1,1)$
 -->
RAND(- 1, 1) and then
reject points which do not satisfy <!-- MATH
 $x^2 + y^2 + z^2 \le 1$
 -->
<I>x</I><SUP>2</SUP> + <I>y</I><SUP>2</SUP> + <I>z</I><SUP>2</SUP><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1.  The
probability of acceptance is then the ratio of the volume of the
sphere of radius 1 to the volume of the enclosing cube of side 2.
This is 4<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">/3 to 8, or 0.52.  Points <I>on</I> the sphere can
be chosen by first picking a point in the ball, and then projecting
onto the sphere.

<P>
Alternatively, we can choose longitude from <!-- MATH
 $\text{RAND}[0,2\pi)$
 -->
RAND[0, 2<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">), and
latitude from a distribution which reflects the resulting areas.  for
simplicity we choose a point at random in the northern hemisphere of a
sphere of radius 1, and indicate at the end how the idea can be
modified.  Let <!-- MATH
 $\vartheta = 2\pi * \text{RAND}()$
 -->
<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$"> = 2<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">*RAND(), choose <!-- MATH
 $x =
\text{RAND}()$
 -->
<I>x</I> = RAND(), and let
<!-- MATH
 \begin{displaymath}
r = f(x) = \sqrt{2x - x^2}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<I>r</I> = <I>f</I> (<I>x</I>) = <IMG
 WIDTH="73" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img455.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img455.gif"
 ALT="$\displaystyle \sqrt{2x - x^2}$">
</DIV><P></P>
Note that <!-- MATH
 $f:[0,1] \to [0,1]$
 -->
<I>f</I> : [0, 1]<IMG
 WIDTH="20" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img54.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img54.gif"
 ALT="$ \to$">[0, 1] is monotone increasing, and so has an
inverse function.  Then <!-- MATH
 $0 \le r \le 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>r</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1, so the point with polar
co-ordinates <!-- MATH
 $(r,\vartheta)$
 -->
(<I>r</I>,<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">) lies in the unit disc.  We take this to
be the equatorial disc, and pick as our point in the northern
hemisphere the unique point which projects down to the point
<!-- MATH
 $(r,\vartheta)$
 -->
(<I>r</I>,<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img454.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img454.gif"
 ALT="$ \vartheta$">).  Clearly the angular distribution is uniform; to show
that this choice is random, it is thus enough to show that the
probability of choosing <!-- MATH
 $0 \le a < r < b \le 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>a</I> &lt; <I>r</I> &lt; <I>b</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1 is the same as
proportion of the area of the hemisphere which sits above this
annulus.

<P>
To this end recall the classical result, which can also be easily
proved using calculus, that the area of a spherical cap is the same as
the area of a cylinder of the same radius as the sphere whose height
is the height of the cap.  The area of that portion of the unit
hemisphere which sits above the annulus <!-- MATH
 $0 \le a < r < b \le 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>a</I> &lt; <I>r</I> &lt; <I>b</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1 is
thus
<!-- MATH
 \begin{displaymath}
\     2\pi\left(1 - \sqrt{1 - b^2}\right)
	- 2\pi\left(1 - \sqrt{1 - a^2}\right)
\     = 2\pi\left(\sqrt{1 - a^2}-\sqrt{1 - b^2}\right).
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;2<IMG
 WIDTH="14" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img72.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img72.gif"
 ALT="$\displaystyle \pi$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img456.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img456.gif"
 ALT="$\displaystyle \left(\vphantom{1 - \sqrt{1 - b^2}}\right.$">1 - <IMG
 WIDTH="61" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img457.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img457.gif"
 ALT="$\displaystyle \sqrt{1 - b^2}$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img458.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img458.gif"
 ALT="$\displaystyle \left.\vphantom{1 - \sqrt{1 - b^2}}\right)$"> - 2<IMG
 WIDTH="14" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img72.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img72.gif"
 ALT="$\displaystyle \pi$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img459.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img459.gif"
 ALT="$\displaystyle \left(\vphantom{1 - \sqrt{1 - a^2}}\right.$">1 - <IMG
 WIDTH="63" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img460.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img460.gif"
 ALT="$\displaystyle \sqrt{1 - a^2}$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img461.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img461.gif"
 ALT="$\displaystyle \left.\vphantom{1 - \sqrt{1 - a^2}}\right)$">&nbsp; = 2<IMG
 WIDTH="14" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img72.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img72.gif"
 ALT="$\displaystyle \pi$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img462.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img462.gif"
 ALT="$\displaystyle \left(\vphantom{\sqrt{1 - a^2}-\sqrt{1 - b^2}}\right.$"><IMG
 WIDTH="63" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img460.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img460.gif"
 ALT="$\displaystyle \sqrt{1 - a^2}$"> - <IMG
 WIDTH="61" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img457.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img457.gif"
 ALT="$\displaystyle \sqrt{1 - b^2}$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img463.gif"
 ALT="$\displaystyle \left.\vphantom{\sqrt{1 - a^2}-\sqrt{1 - b^2}}\right)$">.
</DIV><P></P>
since the area of the hemisphere is 2<IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img22.gif"
 ALT="$ \pi$">, we must show that the
probability of choosing <!-- MATH
 $0 \le a < r < b \le 1$
 -->
0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>a</I> &lt; <I>r</I> &lt; <I>b</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$">1 is <!-- MATH
 $\left(\sqrt{1 -
a^2}-\sqrt{1 - b^2}\right)$
 -->
<IMG
 WIDTH="13" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img464.gif"
 ALT="$ \left(\vphantom{\sqrt{1 -
a^2}-\sqrt{1 - b^2}}\right.$"><IMG
 WIDTH="60" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img465.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img465.gif"
 ALT="$ \sqrt{1 -
a^2}$"> - <IMG
 WIDTH="59" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img466.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img466.gif"
 ALT="$ \sqrt{1 - b^2}$"><IMG
 WIDTH="13" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img467.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img467.gif"
 ALT="$ \left.\vphantom{\sqrt{1 -
a^2}-\sqrt{1 - b^2}}\right)$">.

<P>
Let <!-- MATH
 $g(r) = 1 - \sqrt{1 - r^2}$
 -->
<I>g</I>(<I>r</I>) = 1 - <IMG
 WIDTH="60" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img468.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img468.gif"
 ALT="$ \sqrt{1 - r^2}$">, so <I>g</I>(<I>r</I>) = <I>x</I>, and <I>f</I> and <I>g</I> are
inverse functions.  Computing probabilities,
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">Pr(<I>a</I> &lt; <I>r</I> &lt; <I>b</I>)&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT">= Pr(<I>g</I>(<I>a</I>) &lt; <I>g</I>(<I>r</I>) &lt; <I>g</I>(<I>b</I>))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since <I>g</I> is monotone,</TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT">= Pr<IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img469.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img469.gif"
 ALT="$\displaystyle \left(\vphantom{ 1 - \sqrt{1 - a^2} &lt; x &lt; 1 -\sqrt{1 - b^2}}\right.$">1 - <IMG
 WIDTH="63" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img460.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img460.gif"
 ALT="$\displaystyle \sqrt{1 - a^2}$"> &lt; <I>x</I> &lt; 1 - <IMG
 WIDTH="61" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img457.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img457.gif"
 ALT="$\displaystyle \sqrt{1 - b^2}$"><IMG
 WIDTH="16" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="img470.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img470.gif"
 ALT="$\displaystyle \left.\vphantom{ 1 - \sqrt{1 - a^2} &lt; x &lt; 1 -\sqrt{1 - b^2}}\right)$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT">= <IMG
 WIDTH="63" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img460.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img460.gif"
 ALT="$\displaystyle \sqrt{1 - a^2}$"> - <IMG
 WIDTH="61" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="img457.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img457.gif"
 ALT="$\displaystyle \sqrt{1 - b^2}$">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since <I>x</I> is uniformly distributed.</TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
Of course this is the calculation used to determine <I>f</I> in the first
place.

<P>
To map to the whole sphere, choose <I>x</I> at random from [-1,1); then use
the sign of <I>x</I> to determine whether to go to the northern or southern
hemispheres, and | <I>x</I>| in place of <I>x</I> to determine <I>r</I>.

<P>

<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:random-symmetric" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:random-symmetric">5.4</A>:<A NAME="A:random-symmetric"></A>Let the matrix <I>A</I> have entries <I>a</I><SUB>ij</SUB> for <!-- MATH
 $1 \le i,j \le n$
 -->
1<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>i</I>, <I>j</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img73.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img73.gif"
 ALT="$ \le$"><I>n</I>.  For
<I>i</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img141.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img141.gif"
 ALT="$ \ge$"><I>j</I> define <!-- MATH
 $a_{ij} = 2*\text{RAND } -1$
 -->
<I>a</I><SUB>ij</SUB> = 2*RAND - 1, and let <!-- MATH
 $a{ij} =
a_{ji}$
 -->
<I>aij</I> = <I>a</I><SUB>ji</SUB> if <I>i</I> &lt; <I>j</I>.  Clearly <I>A</I> is symmetric, while each entry is
uniformly distributed on [- 1, 1); to avoid the possibility of getting
-1 as an entry, simply make another selection using the random
number generator should it be chosen.
<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:random-int" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:random-int">5.5</A>:<A NAME="A:random-int"></A>No solution offered.
<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:sampling" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:sampling">5.6</A>:<A NAME="A:sampling"></A>Assume we have chosen <I>k</I> - 1 items in the way described, and are trying
to choose the <!-- MATH
 $k^{\text{th}}$
 -->
<I>k</I><SUP>th</SUP> such item.  We are successful at the
first choice if any of the remaining <I>n</I> - <I>k</I> + 1 items are chosen; this
occurs with probability (<I>n</I> - <I>k</I> + 1)/<I>n</I>.  In the same way, we need two
choices if we fail at the first attempt (probability (<I>k</I> - 1)/<I>n</I>), and
succeed at the second (probability (<I>n</I> - <I>k</I> + 1)/<I>n</I> as before); thus with
total probability
<!-- MATH
 \begin{displaymath}
\     \left(\frac{k-1}{n}\right)\frac{n-k+1}{n}.
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img471.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img471.gif"
 ALT="$\displaystyle \left(\vphantom{\frac{k-1}{n}}\right.$"><IMG
 WIDTH="44" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img472.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img472.gif"
 ALT="$\displaystyle {\frac{k-1}{n}}$"><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img473.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img473.gif"
 ALT="$\displaystyle \left.\vphantom{\frac{k-1}{n}}\right)$"><IMG
 WIDTH="73" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img474.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img474.gif"
 ALT="$\displaystyle {\frac{n-k+1}{n}}$">.
</DIV><P></P>
Of course we may need three, four etc choices before we succeed.  The
<I>expected</I> number of choices is thus
<!-- MATH
 \begin{displaymath}
\     \frac{n-k+1}{n}\left(1.1 + 2.\frac{k-1}{n} +
	3.\left(\frac{k-1}{n}\right)^2 + \cdots\right)
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<IMG
 WIDTH="73" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img474.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img474.gif"
 ALT="$\displaystyle {\frac{n-k+1}{n}}$"><IMG
 WIDTH="19" HEIGHT="63" ALIGN="MIDDLE" BORDER="0"
 SRC="img475.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img475.gif"
 ALT="$\displaystyle \left(\vphantom{1.1 + 2.\frac{k-1}{n} +
3.\left(\frac{k-1}{n}\right)^2 + \cdots}\right.$">1.1 + 2.<IMG
 WIDTH="44" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img472.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img472.gif"
 ALT="$\displaystyle {\frac{k-1}{n}}$"> + 3.<IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img471.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img471.gif"
 ALT="$\displaystyle \left(\vphantom{\frac{k-1}{n}}\right.$"><IMG
 WIDTH="44" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img472.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img472.gif"
 ALT="$\displaystyle {\frac{k-1}{n}}$"><IMG
 WIDTH="25" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="img476.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img476.gif"
 ALT="$\displaystyle \left.\vphantom{\frac{k-1}{n}}\right)^{2}_{}$"> + <SUP> ... </SUP><IMG
 WIDTH="19" HEIGHT="63" ALIGN="MIDDLE" BORDER="0"
 SRC="img477.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img477.gif"
 ALT="$\displaystyle \left.\vphantom{1.1 + 2.\frac{k-1}{n} +
3.\left(\frac{k-1}{n}\right)^2 + \cdots}\right)$">
</DIV><P></P>
Recall that
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">1 + 2<I>x</I> + 3<I>x</I><SUP>2</SUP> + <SUP> ... </SUP>&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT">= <IMG
 WIDTH="25" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img478.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img478.gif"
 ALT="$\displaystyle {\frac{d}{dx}}$">(1 + <I>x</I> + <I>x</I><SUP>2</SUP> + <SUP> ... </SUP>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if | <I>x</I>| &lt; 1,</TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD NOWRAP ALIGN="LEFT">= <IMG
 WIDTH="25" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img478.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img478.gif"
 ALT="$\displaystyle {\frac{d}{dx}}$">(1 - <I>x</I>)<SUP>-1</SUP> = (1 - <I>x</I>)<SUP>-2</SUP>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if | <I>x</I>| &lt; 1,</TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
Thus the expected number of choices is
<!-- MATH
 \begin{displaymath}
\frac{n-k+1}{n}\left(1 - \frac{k-1}{n}\right)^2 = \frac{n}{n-k+1}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="73" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img474.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img474.gif"
 ALT="$\displaystyle {\frac{n-k+1}{n}}$"><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img479.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img479.gif"
 ALT="$\displaystyle \left(\vphantom{1 - \frac{k-1}{n}}\right.$">1 - <IMG
 WIDTH="44" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img472.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img472.gif"
 ALT="$\displaystyle {\frac{k-1}{n}}$"><IMG
 WIDTH="25" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="img480.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img480.gif"
 ALT="$\displaystyle \left.\vphantom{1 - \frac{k-1}{n}}\right)^{2}_{}$"> = <IMG
 WIDTH="73" HEIGHT="43" ALIGN="MIDDLE" BORDER="0"
 SRC="img234.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img234.gif"
 ALT="$\displaystyle {\frac{n}{n-k+1}}$">
</DIV><P></P>
as claimed.

<P>
As in the question, this then gives
<!-- MATH
 \begin{displaymath}
\     w(n,k) = n\left(
		\frac{1}{n} + \frac{1}{n-1} + \cdots + \frac{1}{n-k+1}
\               \right)
	   = n(H_n - H_{n-k}).
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<I>w</I>(<I>n</I>, <I>k</I>) = <I>n</I><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img235.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img235.gif"
 ALT="$\displaystyle \left(\vphantom{\frac{1}{n} + \frac{1}{n-1} + \cdots + \frac{1}{n-k+1}
}\right.$"><IMG
 WIDTH="17" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img41.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img41.gif"
 ALT="$\displaystyle {\frac{1}{n}}$"> + <IMG
 WIDTH="45" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img51.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img51.gif"
 ALT="$\displaystyle {\frac{1}{n-1}}$"> + <SUP> ... </SUP> + <IMG
 WIDTH="73" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img236.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img236.gif"
 ALT="$\displaystyle {\frac{1}{n-k+1}}$">&nbsp;<IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img237.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img237.gif"
 ALT="$\displaystyle \left.\vphantom{\frac{1}{n} + \frac{1}{n-1} + \cdots + \frac{1}{n-k+1}
}\right)$"> = <I>n</I>(<I>H</I><SUB>n</SUB> - <I>H</I><SUB>n - k</SUB>).
</DIV><P></P>
Since <!-- MATH
 $w(n,1) = 1$
 -->
<I>w</I>(<I>n</I>, 1) = 1, we have
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR>
<TD COLSPAN=3 ALIGN="LEFT">
<BR>
and using the approximation <!-- MATH
 $H_n \sim \log(n)$
 -->
<I>H</I><SUB>n</SUB> <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img1.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img1.gif"
 ALT="$ \sim$"> log(<I>n</I>),<P>
<BR></TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT">&nbsp;<IMG
 WIDTH="58" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img238.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img238.gif"
 ALT="$\displaystyle {\frac{w(n,k)}{k}}$"></TD>
<TD NOWRAP ALIGN="LEFT">= <IMG
 WIDTH="17" HEIGHT="43" ALIGN="MIDDLE" BORDER="0"
 SRC="img481.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img481.gif"
 ALT="$\displaystyle {\frac{n}{k}}$"><IMG
 WIDTH="12" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img482.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img482.gif"
 ALT="$\displaystyle \left(\vphantom{H_n - H_{n-k}}\right.$"><I>H</I><SUB>n</SUB> - <I>H</I><SUB>n - k</SUB><IMG
 WIDTH="12" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img483.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img483.gif"
 ALT="$\displaystyle \left.\vphantom{H_n - H_{n-k}}\right)$"></TD>
<TD NOWRAP ALIGN="RIGHT">= <IMG
 WIDTH="18" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img239.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img239.gif"
 ALT="$\displaystyle {\frac{1}{\alpha}}$">log<IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img484.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img484.gif"
 ALT="$\displaystyle \left(\vphantom{\frac{n}{n-k}}\right.$"><IMG
 WIDTH="46" HEIGHT="43" ALIGN="MIDDLE" BORDER="0"
 SRC="img485.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img485.gif"
 ALT="$\displaystyle {\frac{n}{n-k}}$"><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img486.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img486.gif"
 ALT="$\displaystyle \left.\vphantom{\frac{n}{n-k}}\right)$"> = <IMG
 WIDTH="18" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img239.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img239.gif"
 ALT="$\displaystyle {\frac{1}{\alpha}}$">log<IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img240.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img240.gif"
 ALT="$\displaystyle \left(\vphantom{\frac{1}{1-\alpha}}\right.$"><IMG
 WIDTH="46" HEIGHT="49" ALIGN="MIDDLE" BORDER="0"
 SRC="img241.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img241.gif"
 ALT="$\displaystyle {\frac{1}{1-\alpha}}$"><IMG
 WIDTH="18" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img242.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img242.gif"
 ALT="$\displaystyle \left.\vphantom{\frac{1}{1-\alpha}}\right)$">.</TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>

<P>

<P>
<BR>

<P>
<I>Solution</I> <A HREF="node87.html#Q:triangle-etc" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node87.html#Q:triangle-etc">5.7</A>:<A NAME="A:triangle-etc"></A>
<P><P>
<BR>
a) We give the pseudocode for the Running Sample algorithm in
Fig.&nbsp;<A HREF="#C:runningsample"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/crossref.gif"></A>
<BR CLEAR="ALL">
<HR>
<DIV ALIGN="LEFT">
<TT>
 algorithm runningsample(k, N)
<BR>// choose k items at random from N supplied
<BR>
begin
<BR>&nbsp;&nbsp;t = 0
<BR>&nbsp;&nbsp;chosen = 0
<BR>&nbsp;&nbsp;repeat begin
<BR>&nbsp;&nbsp;&nbsp;&nbsp;if ((N-t)*rand() &gt;= (k-chosen)) begin
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pass over next item
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read in next item
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = t + 1
<BR>&nbsp;&nbsp;&nbsp;&nbsp;end
<BR>&nbsp;&nbsp;&nbsp;&nbsp;else begin
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// &nbsp;accept next item
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read in next item
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print out next item
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = t + 1
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chosen = chosen + 1
<BR>&nbsp;&nbsp;&nbsp;&nbsp;end
<BR>&nbsp;&nbsp;end // repeat 
<BR>&nbsp;&nbsp;until (chosen = k)
<BR>
end.
<BR></TT>
</DIV>
<BR CLEAR="ALL">
<HR>
<P>
The logic of this method is that if, at the <I>i</I>th item, we have so
far chosen <I>j</I> items then we have <I>k</I> - <I>j</I> items left to choose from
the remaining <I>N</I> - <I>i</I> + 1 items (including the <I>i</I>th). So it seems
reasonable to choose the <I>i</I>th item with probability
<!-- MATH
 \begin{displaymath}
\     \frac{k-j}{n-i+1}
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<IMG
 WIDTH="70" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img204.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img204.gif"
 ALT="$\displaystyle {\frac{k-j}{n-i+1}}$">
</DIV><P></P>
and that's what the algorithm does.

<P>
We cannot end up with more than <I>k</I> items because we stop the loop if
we have got k.  It is thus enough to show that we cannot end up with
<I>fewer</I> than <I>k</I>.  Suppose conversely that we had ended up with
<I>j</I> &lt; <I>k</I> items and that the last item <I>not</I> chosen was the <I>i</I>th.
Then, at that stage, we had already chosen <I>j</I> - (<I>N</I> - <I>i</I>) items.  So the
probability of choosing the <I>i</I>th was
<!-- MATH
 \begin{displaymath}
\     \frac{k-(j-(N-i))}{N-i+1} = \frac{N-i + (k-j)}{N-i+1} \ge 1,
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
&nbsp;<IMG
 WIDTH="127" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img205.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img205.gif"
 ALT="$\displaystyle {\frac{k-(j-(N-i))}{N-i+1}}$"> = <IMG
 WIDTH="115" HEIGHT="53" ALIGN="MIDDLE" BORDER="0"
 SRC="img206.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img206.gif"
 ALT="$\displaystyle {\frac{N-i + (k-j)}{N-i+1}}$"><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img28.gif"
 ALT="$\displaystyle \ge$">1,
</DIV><P></P>
so we <I>must</I> have chosen it!  Contradiction.

<P>

<P><P>
<BR>
b) 
Our algorithm identifies the half of the equilateral triangle to the
left of the <I>x</I> - axis with the remaining half of the square
<!-- MATH
 \begin{displaymath}
S = \{(x,y)\mid 0\le x \le 1, 0 \le y \le2\},
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<I>S</I> = {(<I>x</I>, <I>y</I>) | 0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>x</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$">1, 0<IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$"><I>y</I><IMG
 WIDTH="16" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.gif" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/img11.gif"
 ALT="$\displaystyle \le$">2},
</DIV><P></P>
namely the half above the line <!-- MATH
 $y + 2x = 2$
 -->
<I>y</I> + 2<I>x</I> = 2.  Our algorithm is then
<DIV ALIGN="LEFT">
<TT>
 x = RAND();
<BR>
y = RAND();
<BR><B>if</B> ( y &gt; 2 - 2*x) <B>then</B>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;x = -1 + x
<BR>&nbsp;&nbsp;&nbsp;&nbsp;y = 2 - y
<BR><B>endif</B>
<BR><B>return</B> (x,y)
<BR></TT>
</DIV>

<P>
The pair (<I>x</I>, <I>y</I>) are chosen uniformly from a rectangle with the same
area as the given triangle.  Our algorithm aranges to use all the
points produced, while the transformation which maps the part of the
square outside the equilateral triangle to the ``missing'' part of the
triangle is Euclidean and hence preserves areas.
<P>

<P>
<BR>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1918"
  HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/next.gif"></A> 
<A NAME="tex2html1912"
  HREF="node103.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node103.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/up.gif"></A> 
<A NAME="tex2html1906"
  HREF="node109.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node109.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/prev.gif"></A> 
<A NAME="tex2html1914"
  HREF="node1.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/contents.gif"></A> 
<A NAME="tex2html1916"
  HREF="node113.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node113.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/maths/faces/local/lib/latex2html-2K.1beta/icons/index.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1919"
  HREF="node111.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node111.html">Solutions for Questions&nbsp;6 (page</A>
<B> Up:</B> <A NAME="tex2html1913"
  HREF="node103.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node103.html">Appendices</A>
<B> Previous:</B> <A NAME="tex2html1907"
  HREF="node109.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node109.html">Solutions for Questions&nbsp;4 (page</A>
 &nbsp <B>  <A NAME="tex2html1915"
  HREF="node1.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html1917"
  HREF="node113.html" tppabs="http://www.maths.abdn.ac.uk/~igc/tch/mx4002/notes/node113.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Ian Craw
2001-04-27
</ADDRESS>
</BODY>
</HTML>
