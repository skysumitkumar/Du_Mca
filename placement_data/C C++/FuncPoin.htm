<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0059)http://www.cprogramming.com/tutorial/function-pointers.html -->
<HTML><HEAD><TITLE>Function Pointers in C and C++ - Cprogramming.com</TITLE><LINK 
href="FuncPoin_files/style.css" type=text/css rel=stylesheet>
<META http-equiv=name content="C&#10;and C++ game programming">
<META 
content="Programming, C++,&#10;C++ tutorials, C++ programming, C programming, tutorials, C++ compilers, c&#10;compilers, source code, basic C++ tutorials, Programming in C++, tutorial,&#10;DJGPP, source code, Programming, C, tutorial, DJGPP, C++ source code, basic C++&#10;tutorial, programming quiz, computer science, computer science quiz, C++&#10;quiz, computer programming, programming computers, how to program computers" 
name=Keywords>
<META 
content="Learn how to take advantage of auto_ptr for&#10;managing memory in C++." 
name=Description>
<META http-equiv=Content-Type content="text/html;&#10;charset=iso-8859-1">
<META content="MSHTML 5.50.4134.600" name=GENERATOR></HEAD>
<BODY><A href="http://www.cprogramming.com/"><IMG class=logo height=83 
src="FuncPoin_files/title.gif" width=324 border=0></A> 
<TABLE class=line>
  <TBODY>
  <TR>
    <TD></TD></TR></TBODY></TABLE>
<DIV align=right>
<FORM action=http://www.google.com/custom method=get target=google_window>
<TABLE bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD vAlign=top noWrap align=left height=32><A 
      href="http://www.google.com/"><IMG alt=Google 
      src="FuncPoin_files/Logo_25wht.gif" border=0></IMG></A></TD>
    <TD noWrap><INPUT type=hidden value=cprogramming.com name=domains></INPUT> 
      <INPUT maxLength=255 size=31 name=q></INPUT><INPUT type=submit value=Search name=sa></INPUT></TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD noWrap>
      <TABLE>
        <TBODY>
        <TR>
          <TD><INPUT type=radio value="" name=sitesearch></INPUT><FONT 
            color=#000000 size=-1>Web</FONT></TD>
          <TD><INPUT type=radio CHECKED value=cprogramming.com 
            name=sitesearch></INPUT><FONT color=#000000 
            size=-1>cprogramming.com</FONT></TD></TR></TBODY></TABLE><INPUT 
      type=hidden value=pub-2560316224908115 name=client></INPUT><INPUT 
      type=hidden value=1 name=forid></INPUT><INPUT type=hidden value=ISO-8859-1 
      name=ie></INPUT><INPUT type=hidden value=ISO-8859-1 name=oe></INPUT><INPUT 
      type=hidden 
      value=GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:50;L:http://www.cprogramming.com/cprog.gif;S:http://www.cprogramming.com;FORID:1; 
      name=cof></INPUT><INPUT type=hidden value=en 
name=hl></INPUT></TD></TR></TBODY></TABLE></FORM></DIV>
<DIV>
<TABLE class=main>
  <TBODY>
  <TR>
    <TD bgColor=#ebebeb colSpan=5><IMG height=6 
      src="FuncPoin_files/spacer-vert.gif" width=0> 
      <CENTER>
      <DIV class=leaderboard><!-- TF 728x90 JScript VAR code -->
      <CENTER>
      <SCRIPT language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=Cprogrammingcom&adSpace=ROS&size=728x90&type=var&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</SCRIPT>
      <NOSCRIPT><A target=_blank 
      href="http://a.tribalfusion.com/i.click?site=Cprogrammingcom&amp;adSpace=ROS&amp;size=728x90&amp;requestID=1272454918"><IMG 
      height=90 alt="Click Here" src="FuncPoin_files/520366.gif" width=728 
      border=0></A> 
      </NOSCRIPT></CENTER><!-- TF 728x90 JScript VAR code --></DIV></CENTER><IMG 
      height=4 src="FuncPoin_files/spacer-vert.gif" width=1> </TD></TR>
  <TR>
    <TD class=divider-horiz colSpan=5></TD></TR>
  <TR>
    <TD vAlign=top width=130 bgColor=#ebebeb>
      <CENTER>
      <DIV class=menu valign="top">
      <P class=navcategory align=left><IMG class=bullet height=13 
      src="FuncPoin_files/bullet.gif" width=11> Starting out </P>
      <P class=navlist align=left><A 
      href="http://www.cprogramming.com/begin.html">Getting Started</A><BR><A 
      href="http://www.cprogramming.com/tutorial.html">Tutorials</A><BR><A 
      href="http://www.cprogramming.com/quiz/">Quizzes</A> </P>
      <P class=navcategory align=left><BR><IMG class=bullet height=13 
      src="FuncPoin_files/bullet.gif" width=11> Moving on </P>
      <P class=navlist align=left><A 
      href="http://www.cprogramming.com/advtutorial.html">Advanced 
      Tutorials</A><BR><A 
      href="http://www.cprogramming.com/articles.html">Articles</A><BR><A 
      href="http://www.cprogramming.com/challenge.html">Challenges</A><BR><A 
      href="http://contests.cprogramming.com/">Contests</A> <BR><A 
      href="http://www.cprogramming.com/tips">Tips and Tricks</A><BR><A 
      href="http://www.cprogramming.com/jobs/">Jobs</A> </P>
      <P class=navcategory align=left><BR><IMG class=bullet height=13 
      src="FuncPoin_files/bullet.gif" width=11> Tools </P>
      <P class=navlist align=left><A 
      href="http://www.cprogramming.com/tools.html">What do I need?</A><BR><A 
      href="http://www.cprogramming.com/compilers.html">Compilers</A><BR><A 
      href="http://www.cprogramming.com/texteditors.html">Editors</A><BR><A 
      href="http://www.cprogramming.com/debuggers.html">Debuggers</A> </P>
      <P class=navcategory align=left><BR><IMG class=bullet height=13 
      src="FuncPoin_files/bullet.gif" width=11> Resources </P>
      <P class=navlist align=left><A 
      href="http://www.cprogramming.com/cgi-bin/source/source.cgi">Source 
      Code</A><BR><A href="http://www.cprogramming.com/reference/">Syntax 
      Reference</A><BR><A 
      href="http://www.cprogramming.com/snippets/">Snippets</A><BR><A 
      href="http://www.cprogramming.com/cgi-bin/cdir/Cdirectory.cgi">Links 
      Directory</A><BR><A 
      href="http://www.cprogramming.com/cgi-bin/glossary/glossary.pl">Glossary</A><BR><A 
      href="http://www.cprogramming.com/books.html">Book Reviews</A><BR><A 
      href="http://www.cprogramming.com/function.html">Function Lookup</A> </P>
      <P class=navcategory align=left><BR><IMG class=bullet height=13 
      src="FuncPoin_files/bullet.gif" width=11> Questions </P>
      <P class=navlist align=left><A 
      href="http://faq.cprogramming.com/">Programming FAQ</A><BR><A 
      href="http://www.cprogramming.com/board.html">Message Board</A><BR><A 
      href="http://www.cprogramming.com/expert.html">Ask an Expert</A><BR><A 
      href="http://www.cprogramming.com/email.html">Email</A> </P></DIV><!-- AI Horizon Link Image START --><BR><BR>
      <SCRIPT type=text/javascript><!-- 
 google_ad_client = "pub-2560316224908115"; google_ad_width = 120; google_ad_height = 90; google_ad_format = "120x90_0ads_al"; google_ad_channel ="9079022593"; google_color_border = "EBEBEB"; google_color_bg = "EBEBEB"; google_color_link = "C30000"; google_color_url = "C30000"; google_color_text = "000000"; //--></SCRIPT>

      <SCRIPT src="FuncPoin_files/show_ads.js" type=text/javascript> </SCRIPT>
      <A onmouseover="window.status='An Affiliate of AIHorizon'; return true" 
      onmouseout="window.status=''; return true" 
      href="http://www.aihorizon.com/"><BR><BR><IMG height=34 
      alt="An Affiliate of AIHorizon" src="FuncPoin_files/aihorizon.gif" 
      width=90 border=1></A> <!-- AI Horizon Link Image END --><BR><BR><!-- The Hunger Site Link START --><A 
      href="http://www.thehungersite.com/"><IMG height=45 
      src="FuncPoin_files/hs.gif" width=90 border=0> </A><BR><BR></CENTER></TD>
    <TD class=divider></TD>
    <TD class=content vAlign=top>
      <DIV class=content2>
      <H1>Programs as Data: Function Pointers</H1>A function pointer is a 
      variable that stores the address of a function that can later be called 
      through that function pointer. This is useful because functions 
      encapsulate behavior. For instance, every time you need a particular 
      behavior such as drawing a line, instead of writing out a bunch of code, 
      all you need to do is call the function. But sometimes you would like to 
      choose different behaviors at different times in essentially the same 
      piece of code. Read on for concrete examples. 
      <CENTER>
      <SCRIPT type=text/javascript><!--
google_ad_client = "pub-2560316224908115";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
google_ad_channel ="7923043678";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "C30000";
google_color_url = "C30000";
google_color_text = "000000";
//--></SCRIPT>

      <SCRIPT src="FuncPoin_files/show_ads.js" type=text/javascript>
  </SCRIPT>
      </CENTER>
      <H2>Example Uses of Function Pointers</H2>
      <H3>Functions as Arguments to Other Functions</H3>If you were to write a 
      <A 
      href="http://www.cprogramming.com/tutorial/computersciencetheory/sortcomp.html">sort 
      routine</A>, you might want to allow the function's caller to choose the 
      order in which the data is sorted; some programmers might need to sort the 
      data in ascending order, others might prefer descending order while still 
      others may want something similar to but not quite like one of those 
      choices. One way to let your user specify what to do is to provide a flag 
      as an argument to the function, but this is inflexible; the sort function 
      allows only a fixed set of comparison types (e.g., ascending and 
      descending). <BR><BR>A much nicer way of allowing the user to choose how 
      to sort the data is simply to let the user pass in a function to the sort 
      function. This function might take two pieces of data and perform a 
      comparison on them. We'll look at the syntax for this in a bit. 
      <H3>Callback Functions</H3>Another use for function pointers is setting up 
      "listener" or "callback" functions that are invoked when a particular 
      event happens. The function is called, and this notifies your code that 
      something of interest has taken place. <BR><BR>Why would you ever write 
      code with callback functions? You often see it when writing code using 
      someone's library. One example is when you're writing code for a a 
      graphical user interface (GUI). Most of the time, the user will interact 
      with a loop that allows the mouse pointer to move and that redraws the 
      interface. Sometimes, however, the user will click on a button or enter 
      text into a field. These operations are "events" that may require a 
      response that your program needs to handle. How can your code know what's 
      happening? Using Callback functions! The user's click should cause the 
      interface to call a function that you wrote to handle the event. 
      <BR><BR>To get a sense for when you might do this, consider what might 
      happen if you were using a GUI library that had a "create_button" 
      function. It might take the location where a button should appear on the 
      screen, the text of the button, and a function to call when the button is 
      clicked. Assuming for the moment that C (and C++) had a generic "function 
      pointer" type called function, this might look like this: <PRE class=example>void create_button( int x, int y, const char *text, function callback_func );
</PRE>Whenever the button is clicked, callback_func will be invoked. 
      Exactly what callback_func does depends on the button; this is why 
      allowing the create_button function to take a function pointer is useful. 
      <H2>Function Pointer Syntax</H2>The syntax for declaring a function 
      pointer might seem messy at first, but in most cases it's really quite 
      straight-forward once you <B>understand</B> what's going on. Let's look at 
      a simple example: <PRE class=example>void (*foo)(int);
</PRE>In this example, foo is a pointer to a function taking one argument, 
      an integer, and that returns void. It's as if you're declaring a function 
      called "*foo", which takes an int and returns void; now, if *foo is a 
      function, then foo must be a pointer to a function. (Similarly, a 
      declaration like int *x can be read as *x is an int, so x must be a 
      pointer to an int.) <BR><BR>The key to writing the declaration for a 
      function pointer is that you're just writing out the declaration of a 
      function but with (*func_name) where you'd normally just put func_name. 
      <BR><BR>
      <H3>Reading Function Pointer Declarations</H3>Sometimes people get 
      confused when more stars are thrown in: <PRE class=example>void *(*foo)(int *);
</PRE>Here, the key is to read inside-out; notice that the innermost 
      element of the expression is *foo, and that otherwise it looks like a 
      normal function declaration. *foo should refer to a function that returns 
      a void * and takes an int *. Consequently, foo is a pointer to just such a 
      function. 
      <H3>Initializing Function Pointers</H3>To initialize a function pointer, 
      you must give it the address of a function in your program. The syntax is 
      like any other variable: <PRE class=example>#include &lt;stdio.h&gt;
void my_int_func(int x)
{
    printf( "%d\n", x );
}

int main()
{
    void (*foo)(int);
    /* the ampersand is actually optional */
    foo = &amp;my_int_func;

    return 0;
}
</PRE>(Note: all examples are written to be compatible with both C and 
      C++.) 
      <H3>Using a Function Pointer</H3>To call the function pointed to by a 
      function pointer, you treat the function pointer as though it were the 
      name of the function you wish to call. The act of calling it performs the 
      dereference; there's no need to do it yourself: <PRE class=example>#include &lt;stdio.h&gt;
void my_int_func(int x)
{
    printf( "%d\n", x );
}


int main()
{
    void (*foo)(int);
    foo = &amp;my_int_func;

    /* call my_int_func (note that you do not need to write (*foo)(2) ) */
    foo( 2 );
    /* but if you want to, you may */
    (*foo)( 2 );

    return 0;
}
</PRE>Note that function pointer syntax is flexible; it can either look 
      like most other uses of pointers, with &amp; and *, or you may omit that 
      part of syntax. This is similar to how arrays are treated, where a bare 
      array decays to a pointer, but you may also prefix the array with &amp; to 
      request its address. 
      <H2>Function Pointers in the Wild</H2>Let's go back to the sorting example 
      where I suggested using a function pointer to write a generic sorting 
      routine where the exact order could be specified by the programmer calling 
      the sorting function. It turns out that the C function qsort does just 
      that. <BR><BR>From the Linux man pages, we have the following declaration 
      for qsort (from stdlib.h): <PRE class=example> void qsort(void *base, size_t nmemb, size_t size,
            int(*compar)(const void *, const void *));
</PRE>Note the use of void*s to allow qsort to operate on any kind of data 
      (in C++, you'd normally use <A 
      href="http://www.cprogramming.com/tutorial/templates.html">templates</A> 
      for this task, but C++ also allows the use of void* pointers) because 
      void* pointers can point to anything. Because we don't know the size of 
      the individual elements in a void* array, we must give qsort the number of 
      elements, nmemb, of the array to be sorted, base, in addition to the 
      standard requirement of giving the length, size, of the input. <BR><BR>But 
      what we're really interested in is the compar argument to qsort: it's a 
      function pointer that takes two void *s and returns an int. This allows 
      anyone to specify how to sort the elements of the array base without 
      having to write a specialized sorting algorithm. Note, also, that compar 
      returns an int; the function pointed to should return -1 if the first 
      argument is less than the second, 0 if they are equal, or 1 if the second 
      is less than the first. <BR><BR>For instance, to sort an array of numbers 
      in ascending order, we could write code like this: <PRE class=example>#include &lt;stdlib.h&gt;

int int_sorter( const void *first_arg, const void *second_arg )
{
    int first = *(int*)first_arg;
    int second = *(int*)second_arg;
    if ( first &lt; second )
    {
        return -1;
    }
    else if ( first == second )
    {
        return 0;
    }
    else
    {
        return 1;
    }
}

int main()
{
    int array[10];
    int i;
    /* fill array */
    for ( i = 0; i &lt; 10; ++i )
    {
        array[ i ] = 10 - i;
    }
    qsort( array, 10 , sizeof( int ), int_sorter );
    for ( i = 0; i &lt; 10; ++i )
    {
        printf ( "%d\n" ,array[ i ] );
    }

}
</PRE><!--
<br><br>
Often, <a
href=http://www.cprogramming.com/tutorial/typedef.html>typedefs</a>
are used to make code using function pointers somewhat more readable.
-->
      <H2>Using Polymorphism and Virtual Functions Instead of Function Pointers 
      (C++)</H2>You can often avoid the need for explicit function pointers by 
      using virtual functions. For instance, you could write a sorting routine 
      that takes a pointer to a class that provides a virtual function called 
      compare: <PRE class=example>class Sorter
{
    public:
    virtual int compare (const void *first, const void *second);
};

// cpp_qsort, a qsort using C++ features like virtual functions
void cpp_qsort(void *base, size_t nmemb, size_t size, Sorter *compar);
</PRE>inside cpp_qsort, whenever a comparison is needed, 
      compar-&gt;compare should be called. For classes that override this 
      virtual function, the sort routine will get the new behavior of that 
      function. For instance: <PRE class=example>class AscendSorter : public Sorter
{

    virtual int compare (const void*, const void*)
    {
        int first = *(int*)first_arg;
        int second = *(int*)second_arg;
        if ( first &lt; second )
        {
            return -1;
        }
        else if ( first == second )
        {
            return 0;
        }
        else
        {
            return 1;
        }
    }
};
</PRE>and then you could pass in a pointer to an instance of the 
      AscendSorter to cpp_qsort to sort integers in ascending order. 
      <H3>But Are You Really Not Using Function Pointers?</H3>Virtual functions 
      are implemented behind the scenes using function pointers, so you really 
      are using function pointers--it just happens that the compiler makes the 
      work easier for you. Using polymorphism can be an appropriate strategy 
      (for instance, it's used by Java), but it does lead to the overhead of 
      having to create an object rather than simply pass in a function pointer. 
      <H2>Function Pointers Summary</H2>
      <H3>Syntax</H3>
      <H4>Declaring</H4>Declare a function pointer as though you were declaring 
      a function, except with a name like *foo instead of just foo: <PRE class=example>void (*foo)(int);
</PRE>
      <H4>Initializing</H4>You can get the address of a function simply by 
      naming it: <PRE class=example>void foo();
func_pointer = foo;
</PRE>or by prefixing the name of the function with an ampersand: <PRE class=example>void foo();
func_pointer = &amp;foo;
</PRE>
      <H4>Invoking</H4>Invoke the function pointed to just as if you were 
      calling a function. <PRE class=example>func_pointer( arg1, arg2 );
</PRE>or you may optionally dereference the function pointer before 
      calling the function it points to: <PRE class=example>(*func_pointer)( arg1, arg2 );
</PRE>
      <H3>Benefits of Function Pointers</H3>
      <UL>
        <LI>Function pointers provide a way of passing around instructions for 
        how to do something 
        <LI>You can write flexible functions and libraries that allow the 
        programmer to choose behavior by passing function pointers as arguments 
        <LI>This flexibility can also be achieved by using classes with virtual 
        functions </LI></UL><I>I am grateful to Alex Hoffer and Thomas Carriero 
      for their comments on a draft of this article.</I> 
      <HR>
      <B>Related articles</B> <BR><B><A 
      href="http://www.cprogramming.com/tutorial/lesson6.html">What are 
      Pointers?</A> 
      <P align=center>----- <BR>Interested in <A 
      href="http://www.cprogramming.com/advertising.html">advertising with 
      us</A>?<BR>Please read our <A 
      href="http://www.cprogramming.com/privacy.html">privacy policy</A>.<BR><A 
      href="http://www.cprogramming.com/use.html">Copyright</A> © 1997-2006 
      Cprogramming.com. All rights reserved.<BR><BR>Affilated with <A 
      href="http://www.disneylandreport.com/">Disneyland Report: Disney News and 
      Secrets</A> </P></DIV></B></TD>
    <TD class=divider vAlign=top></TD>
    <TD class=content vAlign=top bgColor=#ebebeb>
      <DIV class=content2><BR>
      <DIV class=verticalad><!-- TF 120x600 JScript code -->
      <CENTER>
      <SCRIPT language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=Cprogrammingcom&adSpace=ROS&size=120x600&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</SCRIPT>
      <NOSCRIPT><A target=_blank 
      href="http://a.tribalfusion.com/i.click?site=Cprogrammingcom&amp;adSpace=ROS&amp;size=120x600&amp;requestID=910278051"><IMG 
      height=600 alt="Click Here" src="FuncPoin_files/520266.gif" width=120 
      border=0></A> 
      </NOSCRIPT></CENTER><!-- TF 120x600 JScript code --></DIV><BR></DIV></TD></TR>
  <TR>
    <TD class=divider-horiz vAlign=top colSpan=5></TD></TR>
  <TR>
    <TD vAlign=top bgColor=#ebebeb colSpan=5>
      <CENTER><BR>
      <DIV class=bannerad></DIV><BR></CENTER></TD></TR></TBODY></TABLE></DIV>
<SCRIPT src="FuncPoin_files/adsense_clicklogger.js" 
type=text/javascript></SCRIPT>
</BODY></HTML>
